<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>MySQL Learning Notes | Reverland的行知阁</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="SQL," />
  

  <meta name="description" content="随便看看，来自http://zetcode.com的教程笔记。放到一个文档里便于通过Ctrl+F快速查找。
安装从软件源安装基本是一键安装。
源码安装参见MySQL installation
初步启动和停止服务，反正gentoo下是
sudo /etc/init.d/mysqld start
sudo /etc/init.d/mysqld stop
sudo /etc/init.d/mysqld">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL Learning Notes">
<meta property="og:url" content="http://reverland.org/sql/2014/05/31/mysql-learning-notes/index.html">
<meta property="og:site_name" content="Reverland的行知阁">
<meta property="og:description" content="随便看看，来自http://zetcode.com的教程笔记。放到一个文档里便于通过Ctrl+F快速查找。
安装从软件源安装基本是一键安装。
源码安装参见MySQL installation
初步启动和停止服务，反正gentoo下是
sudo /etc/init.d/mysqld start
sudo /etc/init.d/mysqld stop
sudo /etc/init.d/mysqld">
<meta property="og:updated_time" content="2015-11-15T06:01:31.527Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL Learning Notes">
<meta name="twitter:description" content="随便看看，来自http://zetcode.com的教程笔记。放到一个文档里便于通过Ctrl+F快速查找。
安装从软件源安装基本是一键安装。
源码安装参见MySQL installation
初步启动和停止服务，反正gentoo下是
sudo /etc/init.d/mysqld start
sudo /etc/init.d/mysqld stop
sudo /etc/init.d/mysqld">

  

  
    <link rel="icon" href="/images/favicon.ico">
  

  <link rel="stylesheet" href="/css/styles.css" type="text/css">

  

  

  

</head>

<body>
  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a 
            class="CIRCLE" 
            href="/archives/"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a 
            class="CIRCLE" 
            href="/category/"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a 
            class="CIRCLE" 
            href="/tag/"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a 
            class="CIRCLE" 
            href="/link/"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a 
            class="CIRCLE" 
            href="/about/"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a 
            class="CIRCLE" 
            href="/atom.xml"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#安装"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#初步"><span class="toc-text">初步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#快速教程"><span class="toc-text">快速教程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL存储引擎"><span class="toc-text">MySQL存储引擎</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL数据类型"><span class="toc-text">MySQL数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数值"><span class="toc-text">数值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#日期和时间"><span class="toc-text">日期和时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串"><span class="toc-text">字符串</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建、更改和删除表"><span class="toc-text">创建、更改和删除表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建指令"><span class="toc-text">创建指令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除表"><span class="toc-text">删除表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更改表"><span class="toc-text">更改表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL表达式"><span class="toc-text">MySQL表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#字面常量"><span class="toc-text">字面常量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变量"><span class="toc-text">变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运算符"><span class="toc-text">运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优先级"><span class="toc-text">优先级</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插入、更新和删除数据"><span class="toc-text">插入、更新和删除数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插入"><span class="toc-text">插入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#删除"><span class="toc-text">删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新"><span class="toc-text">更新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SELECT语句"><span class="toc-text">SELECT语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取数据"><span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#排序数据"><span class="toc-text">排序数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WHERE"><span class="toc-text">WHERE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#移除重复项"><span class="toc-text">移除重复项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#聚合数据"><span class="toc-text">聚合数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#选择内容到文件"><span class="toc-text">选择内容到文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#子查询"><span class="toc-text">子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#限制"><span class="toc-text">限制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#导出和导入数据"><span class="toc-text">导出和导入数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#连接表"><span class="toc-text">连接表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#内连接"><span class="toc-text">内连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#外连接"><span class="toc-text">外连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL函数"><span class="toc-text">MySQL函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#数学函数"><span class="toc-text">数学函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#聚合函数"><span class="toc-text">聚合函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串函数"><span class="toc-text">字符串函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#日期时间函数"><span class="toc-text">日期时间函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#系统函数"><span class="toc-text">系统函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL视图"><span class="toc-text">MySQL视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务"><span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#隔离级"><span class="toc-text">隔离级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自动提交"><span class="toc-text">自动提交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开始事务"><span class="toc-text">开始事务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在MySQL中存储例程"><span class="toc-text">在MySQL中存储例程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一个简单过程"><span class="toc-text">一个简单过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#一个简单函数"><span class="toc-text">一个简单函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#过程参数"><span class="toc-text">过程参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#找到过程或函数"><span class="toc-text">找到过程或函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL_C_API"><span class="toc-text">MySQL C API</span></a></li></ol>
  </div>


<a class="back-top" href="#">
  <i class="icon-angle-up"></i>
</a>


<div class="content-post CENTER">
   <article id="post-mysql-learning-notes" class="article article-type-post" itemscope itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">MySQL Learning Notes</h1>

    <div class="article-meta">
      <span>2014-05-31</span>

      <span> | </span>

      <span class="article-author">Liu Yuyang</span>

      <span> | </span>

      
  <span class="article-category">
    <a class="article-category-link" href="/categories/sql/">SQL</a>
  </span>


    </div>
  </header>

  <div class="article-content">
    
      <p>随便看看，来自<a href="http://zetcode.com" target="_blank" rel="external">http://zetcode.com</a>的教程笔记。放到一个文档里便于通过<code>Ctrl+F</code>快速查找。</p>
<h2 id="安装">安装</h2><p>从软件源安装基本是一键安装。</p>
<p>源码安装参见<a href="http://zetcode.com/databases/mysqltutorial/installation" target="_blank" rel="external">MySQL installation</a></p>
<h2 id="初步">初步</h2><p>启动和停止服务，反正gentoo下是</p>
<pre><code>sudo /etc/init.d/mysqld <span class="operator"><span class="keyword">start</span>
sudo /etc/init.<span class="keyword">d</span>/mysqld <span class="keyword">stop</span>
sudo /etc/init.<span class="keyword">d</span>/mysqld restart</span>
</code></pre><p>手动启动<code>mysqld_safe &amp;</code>也行。</p>
<p>检查服务是否启动：</p>
<pre><code> <span class="regexp">~/Work/</span>learn/MySQL ⮀ mysqladmin -uroot -p ping
Enter <span class="string">password:</span> 
mysqld is alive
</code></pre><p><code>mysqladmin</code>还可以用来关闭服务，参见<code>man mysqladmin</code>.</p>
<p><code>mysql -uroot -p</code>直接连接到mysql的交互shell中去。</p>
<p>在这个shell中可以使用命令(比如<code>system pwd</code>)也可以使用SQL语句，SQL语句以分号结束。</p>
<p>查看数据库:</p>
<pre><code><span class="operator"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>;</span>
</code></pre><p>创建数据库<code>mydb</code></p>
<pre><code>CREAT DATABASE mydb<span class="comment">;</span>
</code></pre><p>使用数据库<code>mydb</code></p>
<pre><code><span class="keyword">use</span> <span class="title">mydb</span>;
</code></pre><p>显示数据库中的表：</p>
<pre><code><span class="operator"><span class="keyword">SHOW</span> <span class="keyword">TABLES</span>;</span>
</code></pre><p>执行数据库文件：</p>
<pre><code><span class="built_in">source</span> cars.sql
</code></pre><p>从表中选择：</p>
<pre><code><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars;</span>
</code></pre><p>创建新用户</p>
<pre><code><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">USER</span> user123@localhost <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'pass123'</span>;</span>
</code></pre><p>授予用户对特定数据库/表的特定权限</p>
<pre><code><span class="operator"><span class="keyword">GRANT</span> ALL <span class="keyword">ON</span> mydb.* <span class="keyword">to</span> user123@localhost;</span>
</code></pre><h2 id="快速教程">快速教程</h2><p>root用户：</p>
<ul>
<li>创建数据库</li>
<li>使用数据库</li>
<li>导入数据库文件(吐槽下mysql数据库导入的神慢)</li>
<li>授予权限</li>
</ul>
<p>普通用户：</p>
<ul>
<li>查看数据库</li>
<li>使用数据库</li>
<li>查看表</li>
</ul>
<p>描述表：</p>
<pre><code><span class="operator"><span class="keyword">DESCRIBE</span> City;</span>
</code></pre><p>查看创建表的命令</p>
<pre><code><span class="operator"><span class="keyword">SHOW</span> CREAT <span class="keyword">TABLE</span> City;</span>
</code></pre><p>使用<code>mysqldump</code>备份表(在系统shell中而不是mysql的交互shell)</p>
<pre><code>mysqldump -uroot -<span class="tag">p</span> world City &gt; city.sql
</code></pre><p>移除表</p>
<pre><code><span class="operator"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> City;</span>
</code></pre><p>接着讲讲查表。</p>
<p>限制条数：</p>
<pre><code><span class="operator"><span class="keyword">SELECT</span> <span class="keyword">Id</span>, <span class="keyword">Name</span>, Population <span class="keyword">FROM</span> City <span class="keyword">LIMIT</span> <span class="number">10</span>;</span>
<span class="operator"><span class="keyword">SELECT</span> <span class="keyword">Id</span>, <span class="keyword">Name</span>, Population <span class="keyword">FROM</span> City <span class="keyword">LIMIT</span> <span class="number">15</span>, <span class="number">5</span>;</span>
</code></pre><p>使用<code>less</code>分页，</p>
<pre><code>pager <span class="operator">less</span>
</code></pre><p>非交互式使用SQL命令</p>
<pre><code>mysql -<span class="keyword">u</span> user123 -p world -<span class="keyword">e</span> <span class="string">"SELECT * FROM City"</span> &gt; city
</code></pre><p>COUNT函数</p>
<pre><code><span class="operator"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">Id</span>) <span class="keyword">AS</span> <span class="string">'Number of rows'</span> <span class="keyword">FROM</span> City;</span>
</code></pre><p>MAX, 下面命令显示了SQL的子查询特性:</p>
<pre><code>mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Population <span class="keyword">FROM</span> City
    -&gt; WHERE Population = (<span class="built_in">SELECT</span> <span class="built_in">Max</span>(Population) <span class="keyword">FROM</span> City);
</code></pre><p>MIN:</p>
<pre><code>mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Population <span class="keyword">FROM</span> City
    -&gt; WHERE Population = (<span class="built_in">SELECT</span> <span class="built_in">Min</span>(Population) <span class="keyword">FROM</span> City);
</code></pre><p>WHERE语句</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> Name, Population <span class="keyword">FROM</span> City 
    -&gt; <span class="keyword">WHERE</span> Population &gt; <span class="number">1000000</span>;

mysql&gt; <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> City <span class="keyword">WHERE</span> Name <span class="keyword">LIKE</span> <span class="comment">'Kal%';</span>

mysql&gt; <span class="keyword">SELECT</span> Name, Population <span class="keyword">FROM</span> City 
    -&gt; <span class="keyword">WHERE</span> ID <span class="keyword">IN</span> (<span class="number">5</span>, <span class="number">32</span>, <span class="number">344</span>, <span class="number">554</span>);

mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> City <span class="keyword">WHERE</span> Name = <span class="comment">'Bratislava';</span>

mysql&gt; <span class="keyword">SELECT</span> Name, Population <span class="keyword">FROM</span> City 
    -&gt; <span class="keyword">WHERE</span> Population BETWEEN <span class="number">670000</span> <span class="keyword">AND</span> <span class="number">700000</span>;
</code></pre><p>排序数据</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> Name, Population FROM City
    <span class="subst">-&gt; </span><span class="keyword">ORDER</span> <span class="keyword">BY</span> Population DESC LIMIT <span class="number">10</span>;

mysql&gt; <span class="keyword">SELECT</span> Name, Population FROM City 
    <span class="subst">-&gt; </span><span class="keyword">ORDER</span> <span class="keyword">BY</span> Population ASC LIMIT <span class="number">10</span>;

mysql&gt; <span class="keyword">SELECT</span> Name, Population FROM City 
    <span class="subst">-&gt; </span><span class="keyword">ORDER</span> <span class="keyword">BY</span> Name LIMIT <span class="number">10</span>;
</code></pre><p>聚合数据</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> District, <span class="keyword">SUM</span>(Population) FROM City
    <span class="subst">-&gt; </span><span class="keyword">WHERE</span> District = <span class="string">'Henan'</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> District;

mysql&gt; <span class="keyword">SELECT</span> Name, District, Population FROM City
    <span class="subst">-&gt; </span><span class="keyword">WHERE</span> District = <span class="string">'Henan'</span>;

mysql&gt; <span class="keyword">SELECT</span> District, <span class="keyword">SUM</span>(Population) FROM City
    <span class="subst">-&gt; </span><span class="keyword">WHERE</span> CountryCode = <span class="string">'USA'</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> District
    <span class="subst">-&gt; </span>HAVING <span class="keyword">SUM</span>(Population) &gt; <span class="number">3000000</span>;
</code></pre><p>更新，删除和插入数据</p>
<pre><code>mysql&gt; UPDATE Country <span class="built_in">SET</span> HeadOfState = <span class="string">'Xi Jinping'</span> 
    <span class="subst">-&gt; </span><span class="keyword">WHERE</span> Name = <span class="string">'China'</span>;

mysql&gt; DELETE FROM City <span class="keyword">WHERE</span> ID <span class="keyword">IN</span> (<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>);

mysql&gt; TRUNCATE TABLE City;

mysql&gt; INSERT <span class="keyword">INTO</span> City VALUES(<span class="number">999999</span>, <span class="string">'Kabul'</span>, <span class="string">'AFG'</span>, <span class="string">'Kabol'</span>, <span class="number">1780000</span>);

mysql&gt; DROP TABLE City
</code></pre><h2 id="MySQL存储引擎">MySQL存储引擎</h2><p>存储引擎是数据库管理系统读写更新数据库中数据的软件模型。</p>
<p>MySQL支持的存储引擎有：</p>
<ul>
<li>MyISAM，早于5.5版本的默认引擎</li>
<li>InnoDB</li>
<li>Memory</li>
<li>CSV</li>
<li>等等</li>
</ul>
<p>情况很复杂，选择之前最好上<a href="http://stackoverflow.com/" target="_blank" rel="external">StackOverFlow</a>问问。</p>
<p>创建表时使用<code>ENGINE</code>关键字指定引擎：</p>
<pre><code>mysql&gt; CREATE TABLE Cars(Id <span class="built_in">INTEGER</span> PRIMARY KEY, Name VARCHAR(<span class="number">50</span>), 
    <span class="subst">-&gt; </span>Cost <span class="built_in">INTEGER</span>) ENGINE=<span class="string">'MyISAM'</span>;
</code></pre><p>查看当前引擎：</p>
<pre><code>mysql&gt; SHOW <span class="section"><span class="keyword">VARIABLES</span> LIKE 'storage_engine';</span>
</code></pre><p>发现特定数据库的表引擎</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> ENGINE FROM information_schema<span class="built_in">.</span>TABLES
    <span class="subst">-&gt; </span><span class="keyword">WHERE</span> TABLE_SCHEMA=<span class="string">'mydb'</span>
    <span class="subst">-&gt; </span><span class="subst">AND</span> TABLE_NAME=<span class="string">'Cars'</span>;
</code></pre><p>更改表的引擎：</p>
<pre><code>mysql&gt; ALTER <span class="keyword">TABLE</span> Cars ENGINE=<span class="string">'InnoDB'</span>;
</code></pre><h2 id="MySQL数据类型">MySQL数据类型</h2><h3 id="数值">数值</h3><p>整数：</p>
<table>
<thead>
<tr>
<th>Data type</th>
<th>Bytes</th>
<th>Minimum value</th>
<th>Maximum value</th>
</tr>
</thead>
<tbody>
<tr>
<td>TINYINT</td>
<td>1</td>
<td>-128</td>
<td>127</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2</td>
<td>-32768</td>
<td>32767</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3</td>
<td>-8388608</td>
<td>8388607</td>
</tr>
<tr>
<td>INTEGER</td>
<td>4</td>
<td>-2147483648</td>
<td>2147483647</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8</td>
<td>-9223372036854775808</td>
<td>9223372036854775807</td>
</tr>
</tbody>
</table>
<p>浮点：</p>
<table>
<thead>
<tr>
<th>Data type</th>
<th>Bytes</th>
</tr>
</thead>
<tbody>
<tr>
<td>FLOAT</td>
<td>4</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>8</td>
</tr>
<tr>
<td>DECIML</td>
<td>(M位，小数点后D位)</td>
</tr>
</tbody>
</table>
<p>定义表时指定：</p>
<pre><code>mysql&gt; CREATE TABLE Numbers <span class="list">(<span class="keyword">Id</span> TINYINT, Floats FLOAT, Decimals DECIMAL<span class="list">(<span class="number">3</span>, <span class="number">2</span>)</span>)</span><span class="comment">;</span>
</code></pre><p>更改列字段内型：</p>
<pre><code>mysql&gt; ALTER TABLE Ages MODIFY Age TINYINT UNSIGNED<span class="comment">;</span>
</code></pre><p>插入值</p>
<pre><code><span class="tag">mysql</span>&gt; <span class="tag">INSERT</span> <span class="tag">INTO</span> <span class="tag">Numbers</span> <span class="tag">VALUES</span> (1, 1<span class="class">.1</span>, 1<span class="class">.1</span>), (2, 1<span class="class">.1</span>, 1<span class="class">.1</span>), (3, 1<span class="class">.1</span>, 1<span class="class">.1</span>);
</code></pre><p>DECIMAL类型更加精确，FLOAT和DOUBLE都只是近似。</p>
<h3 id="日期和时间">日期和时间</h3><p>有这么几种：</p>
<table>
<thead>
<tr>
<th>Data type</th>
<th>范围</th>
<th>显示格式</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATE</td>
<td>‘1000-01-01’ 到 ‘9999-12-31’.</td>
<td>YYYY-MM-DD</td>
</tr>
<tr>
<td>TIME</td>
<td>‘-838:59:59’ to ‘838:59:59’.</td>
<td>HH:MM:SS</td>
</tr>
<tr>
<td>DATETIME</td>
<td>‘1000-01-01 00:00:00’ to ‘9999-12-31 23:59:59’.</td>
<td>YYYY-MM-DD HH:MM:SS</td>
</tr>
<tr>
<td>YEAR</td>
<td>1901 to 2155</td>
<td>YYYY</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>‘1970-01-01 00:00:01’ UTC to ‘2038-01-19 03:14:07’ UTC</td>
<td>见下表</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Data type</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr>
<td>TIMESTAMP(14)</td>
<td>YYYYMMDDHHMMSS</td>
</tr>
<tr>
<td>TIMESTAMP(12)</td>
<td>YYMMDDHHMMSS</td>
</tr>
<tr>
<td>TIMESTAMP(10)</td>
<td>YYMMDDHHMM</td>
</tr>
<tr>
<td>TIMESTAMP(8)</td>
<td>YYYYMMDD</td>
</tr>
<tr>
<td>TIMESTAMP(6)</td>
<td>YYMMDD</td>
</tr>
<tr>
<td>TIMESTAMP(4)</td>
<td>YYMM</td>
</tr>
<tr>
<td>TIMESTAMP(2)</td>
<td>YY</td>
</tr>
</tbody>
</table>
<p>DATE、DATETIME和DATE输入时可支持多种格式，分隔符可以任意，超出范围截断到0.</p>
<pre><code>mysql&gt; CREATE <span class="function">TABLE <span class="title">Dates</span><span class="params">(Id TINYINT, Dates DATE)</span></span>;
mysql&gt; INSERT INTO <span class="function">Dates <span class="title">VALUES</span><span class="params">(<span class="number">1</span>, <span class="string">'2011-01-24'</span>)</span></span>;
mysql&gt; INSERT INTO <span class="function">Dates <span class="title">VALUES</span><span class="params">(<span class="number">2</span>, <span class="string">'2011/01/25'</span>)</span></span>;
mysql&gt; INSERT INTO <span class="function">Dates <span class="title">VALUES</span><span class="params">(<span class="number">3</span>, <span class="string">'20110126'</span>)</span></span>;
mysql&gt; INSERT INTO <span class="function">Dates <span class="title">VALUES</span><span class="params">(<span class="number">4</span>, <span class="string">'110127'</span>)</span></span>;
mysql&gt; INSERT INTO <span class="function">Dates <span class="title">VALUES</span><span class="params">(<span class="number">5</span>, <span class="string">'2011+01+28'</span>)</span></span>;
</code></pre><p><code>TIMEDIFF</code>计算时差：</p>
<pre><code>mysql&gt; <span class="function">SELECT <span class="title">TIMEDIFF</span><span class="params">(<span class="string">'23:34:32'</span>, <span class="string">'22:00:00'</span>)</span></span>;
</code></pre><p><code>TIME</code>函数提取时间部分</p>
<pre><code>mysql&gt; <span class="function">SELECT <span class="title">TIME</span><span class="params">(<span class="string">'2011-01-29 11:27:42'</span>)</span></span>;
</code></pre><p><code>DAYNAME</code>函数提取星期名。</p>
<pre><code>mysql&gt; SELECT DAYNAME('<span class="number">2011</span><span class="number">@01</span><span class="number">@29</span> <span class="number">11</span><span class="number">@50</span><span class="number">@13</span>');
</code></pre><p>MySQL自动填充TIMESTAMP列，记录<code>INSERT</code>和<code>UPDATE</code>时间。</p>
<h3 id="字符串">字符串</h3><table>
<thead>
<tr>
<th>Data type</th>
<th>Format</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>CHAR</td>
<td>CHAR(x),x=0:255</td>
<td>定长字符串存储</td>
</tr>
<tr>
<td>VARCHAR</td>
<td>VARCHAR(x),x=0:65535</td>
<td>变长字符串数据存储</td>
</tr>
<tr>
<td>BINARY</td>
<td>BINARY(x),x=0:255</td>
<td>定长字节存储</td>
</tr>
<tr>
<td>VARBINARY</td>
<td>VARBINARY(x),x=0:65535</td>
<td>变长字节存储</td>
</tr>
<tr>
<td>TINYBLOB</td>
<td>0-255</td>
<td>BLOB存储大二进制对象</td>
</tr>
<tr>
<td>BLOB</td>
<td>0-65535</td>
<td></td>
</tr>
<tr>
<td>MEDIUMBLOB</td>
<td>0 - 16777215</td>
<td></td>
</tr>
<tr>
<td>LONGBLOB</td>
<td>0 - 4294967295</td>
<td></td>
</tr>
<tr>
<td>TINYTEXT</td>
<td>0-255</td>
<td>TEXT存储大文本数据</td>
</tr>
<tr>
<td>TEXT</td>
<td>0-65535</td>
<td></td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>0 - 16777215</td>
<td></td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>0 - 4294967295</td>
</tr>
</tbody>
</table>
<p><code>ENUM</code>创建一个只能插入列表中特定值的表</p>
<pre><code>mysql&gt; CREATE TABLE SizeTable<span class="list">(<span class="keyword">Size</span> ENUM<span class="list">(<span class="quoted">'S</span>', <span class="quoted">'M</span>', <span class="quoted">'L</span>', <span class="quoted">'XL</span>', <span class="quoted">'XXL</span>')</span>)</span><span class="comment">;</span>
</code></pre><p><code>SET</code>类似于<code>ENUM</code>，但可以包含0个或多个列表中的值。</p>
<h2 id="创建、更改和删除表">创建、更改和删除表</h2><h3 id="创建指令">创建指令</h3><p>创建一个表，指定表名、列的名称和类型：</p>
<pre><code>mysql&gt; CREATE <span class="keyword">TABLE</span> Testing(Id <span class="keyword">INTEGER</span>);
</code></pre><p>查看某个表的建表语句</p>
<pre><code>mysql&gt; SHOW CREATE TABLE Testing<span class="comment">;</span>
</code></pre><p>创建的，非临时表可以通过<code>SHOW TABLES</code>语法查看：</p>
<pre><code>mysql&gt; SHOW TABLES <span class="keyword">LIKE</span> <span class="comment">'T%';</span>
</code></pre><h2 id="删除表">删除表</h2><p>删除表：</p>
<pre><code>mysql&gt; <span class="keyword">DROP</span> <span class="keyword">TABLE</span> Testing;
</code></pre><h2 id="更改表">更改表</h2><p>使用<code>ALTER TABLE</code>语法更改表。以下为重命名表、添加列、添加主键、更改列、删除列操作。(DESCRIBE和SHOW COLUMNS FROM同义，INTEGER和INT相同)</p>
<pre><code>mysql&gt; ALTER <span class="keyword">TABLE</span> Testing <span class="keyword">RENAME</span> TO TestTable;
mysql&gt; ALTER <span class="keyword">TABLE</span> TestTable ADD iValues INT;
mysql&gt; ALTER <span class="keyword">TABLE</span> TestTable ADD PRIMARY KEY (Id);
mysql&gt; ALTER <span class="keyword">TABLE</span> TestTable CHANGE COLUMN iValues iValues1 INT;
mysql&gt; ALTER <span class="keyword">TABLE</span> TestTable <span class="keyword">DROP</span> COLUMN iValues1;
</code></pre><h2 id="MySQL表达式">MySQL表达式</h2><h3 id="字面常量">字面常量</h3><pre><code>mysql&gt; <span class="keyword">SELECT</span> <span class="number">3</span>, <span class="string">'Wolf'</span>, <span class="number">34.5</span>, <span class="number">0x34</span>, <span class="number">0</span>+b<span class="string">'10111'</span><span class="comment">;</span>
mysql&gt; <span class="keyword">SELECT</span> <span class="literal">NULL</span>, \N<span class="comment">;</span>
mysql&gt; <span class="keyword">SELECT</span> <span class="literal">TRUE</span>, <span class="literal">FALSE</span><span class="comment">;</span>
mysql&gt; <span class="keyword">SELECT</span> <span class="string">'2011-01-11'</span>, <span class="string">'23:33:01'</span>, <span class="string">'98/11/31/ 14:22:20'</span><span class="comment">;</span>
</code></pre><h3 id="变量">变量</h3><pre><code>mysql&gt; SET <span class="constant">@name</span> = <span class="string">'Jane'</span><span class="comment">;</span>
mysql&gt; <span class="keyword">SELECT</span> <span class="constant">@name</span><span class="comment">;</span>
</code></pre><h3 id="运算符">运算符</h3><p>包括一元的</p>
<pre><code>mysql&gt; <span class="function">SELECT <span class="title">NOT</span> <span class="params">(<span class="number">3</span>&gt;<span class="number">9</span>)</span></span>;
</code></pre><p>算术的：</p>
<pre><code>mysql&gt; SELECT <span class="number">9</span>/<span class="number">2</span>, <span class="number">9</span> DIV <span class="number">2</span>;
</code></pre><p>逻辑的：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> <span class="literal">FALSE</span> <span class="keyword">XOR</span> <span class="literal">FALSE</span>, <span class="literal">FALSE</span> <span class="keyword">XOR</span> <span class="literal">TRUE</span>,
-&gt; <span class="literal">TRUE</span> <span class="keyword">XOR</span> <span class="literal">FALSE</span>, <span class="literal">TRUE</span> <span class="keyword">XOR</span> <span class="literal">TRUE</span>;
</code></pre><p>关系的：</p>
<pre><code>mysql&gt; SELECT <span class="number">3</span> * <span class="number">3</span> = <span class="number">9</span>, <span class="number">9</span> = <span class="number">9</span>, <span class="number">3</span> &lt; <span class="number">4</span>, <span class="number">3</span> &lt;&gt; <span class="number">5</span>, <span class="number">4</span> &lt;= <span class="number">4</span>, <span class="number">5</span> != <span class="number">5</span>;
</code></pre><p>位的：</p>
<pre><code>mysql&gt; SELECT <span class="number">6</span> | <span class="number">3</span>, <span class="number">6</span> &amp; <span class="number">3</span>, <span class="number">6</span> &lt;&lt; <span class="number">1</span>;
</code></pre><p>其它：</p>
<pre><code>mysql&gt; <span class="keyword">SET</span> @running = <span class="keyword">FALSE</span>;
mysql&gt; <span class="keyword">SELECT</span> @running <span class="keyword">IS</span> <span class="keyword">FALSE</span>;
mysql&gt; <span class="keyword">SELECT</span> <span class="string">'Tom'</span> <span class="keyword">IN</span> (<span class="string">'Tom'</span>, <span class="string">'Frank'</span>, <span class="string">'Jane'</span>);
mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">Where</span> Name <span class="keyword">IN</span> (<span class="string">'Audi'</span>, <span class="string">'Hummer'</span>);
mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Name LIKE <span class="string">'Vol%'</span>;
mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Name LIKE <span class="string">'____'</span>;
mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Name REGEXP <span class="string">'e.$'</span>;
mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Name REGEXP <span class="string">'^.e.*e.$'</span>;
mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Cost BETWEEN <span class="number">20000</span> <span class="keyword">AND</span> <span class="number">55000</span>;
</code></pre><h3 id="优先级">优先级</h3><p>加个括号吧</p>
<p>同级运算符从左到右执行</p>
<h2 id="插入、更新和删除数据">插入、更新和删除数据</h2><h2 id="插入">插入</h2><p>插入时可以指定插入的列，也可以不指定</p>
<pre><code>mysql&gt; INSERT <span class="keyword">INTO</span> Books(Id, Title, Auth<span class="subst">or</span>) VALUES(<span class="number">1</span>, <span class="string">'War and Peace'</span>, 
<span class="subst">-&gt; </span><span class="string">'Leo Tolstoy'</span>);
mysql&gt; INSERT <span class="keyword">INTO</span> Books VALUES(<span class="number">3</span>, <span class="string">'Crime and Punishment'</span>,
<span class="subst">-&gt; </span><span class="string">'Fyodor Dostoyevsky'</span>);
</code></pre><p>若不指定<code>Id</code>也可。</p>
<pre><code>mysql&gt; INSERT INTO Books<span class="list">(<span class="keyword">Title</span>, Author)</span> VALUES <span class="list">(<span class="quoted">'The</span> Brothers Karamazov',
-&gt; <span class="quoted">'Fyodor</span> Dostoyevsky')</span><span class="comment">;</span>
</code></pre><p>一次可以插入单个或多个值</p>
<pre><code>mysql&gt; INSERT <span class="keyword">INTO</span> Books(Title, Auth<span class="subst">or</span>) VALUES (<span class="string">'The Insulted and Humiliated'</span>,
<span class="subst">-&gt; </span><span class="string">'Fyodor Dostoyevsky'</span>), (<span class="string">'Cousin Bette'</span>, <span class="string">'Honore de Balzac'</span>);
</code></pre><p><code>REPLACE</code>可以取代特定行：</p>
<pre><code>mysql&gt; REPLACE INTO <span class="function">Books <span class="title">VALUES</span><span class="params">(<span class="number">3</span>, <span class="string">'Paradise Lost'</span>, <span class="string">'John Milton'</span>)</span></span>;
</code></pre><p>插入也可以和<code>SELECT</code>结合：</p>
<pre><code>mysql&gt; INSERT <span class="keyword">INTO</span> Books2 <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Books;
</code></pre><p>可以使用<code>LOAD DATA INFILE</code>和<code>LOAD XML INFILE</code>语法从文件插入：</p>
<pre><code>mysql&gt; LOAD <span class="built_in">DATA</span> INFILE <span class="string">'/tmp/books.csv'</span>    
    <span class="subst">-&gt; </span><span class="keyword">INTO</span> TABLE Books    
    <span class="subst">-&gt; </span>FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">','</span>    
    <span class="subst">-&gt; </span>LINES TERMINATED <span class="keyword">BY</span> <span class="string">'\n'</span>;

mysql&gt; LOAD <span class="built_in">XML</span> INFILE <span class="string">'/home/vronskij/programming/mysql/books.xml'</span> <span class="keyword">INTO</span> TABLE Books;
</code></pre><h3 id="删除">删除</h3><p>从表中删除：</p>
<pre><code>mysql&gt; <span class="keyword">DELETE</span> <span class="keyword">FROM</span> Books2 WHERE Id=<span class="number">1</span>;
mysql&gt; <span class="keyword">DELETE</span> <span class="keyword">FROM</span> Books2;
mysql&gt; TRUNCATE Books2;
</code></pre><h3 id="更新">更新</h3><p><code>UPDATE</code>用于变更选中行的列值。</p>
<p>mysql&gt; UPDATE Books SET Author=’Lev Nikolayevich Tolstoy’<br>    -&gt; WHERE Id=1;</p>
<h2 id="SELECT语句">SELECT语句</h2><h3 id="获取数据">获取数据</h3><p>选择所有内容</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars;
</code></pre><p>选择特定的列</p>
<pre><code>mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Cost <span class="keyword">FROM</span> Cars;
</code></pre><p>可以重命名列名：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> Name, Cost <span class="keyword">AS</span> Price <span class="keyword">FROM</span> Cars;
</code></pre><p>限制输出个数：</p>
<pre><code>mysql&gt; <span class="built_in">SELECT</span> * <span class="keyword">FROM</span> Cars LIMIT <span class="number">4</span>;
mysql&gt; <span class="built_in">SELECT</span> * <span class="keyword">FROM</span> Cars LIMIT <span class="number">2</span>, <span class="number">4</span>;
mysql&gt; <span class="built_in">SELECT</span> * <span class="keyword">FROM</span> Cars LIMIT <span class="number">4</span> OFFSET <span class="number">2</span>;  <span class="preprocessor"># 同上</span>
</code></pre><h3 id="排序数据">排序数据</h3><p>以降序(<code>DESC</code>)或升序(<code>ASC</code>)排序：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> Name, Cost <span class="keyword">FROM</span> Cars <span class="keyword">ORDER</span> <span class="keyword">BY</span> Cost <span class="keyword">DESC</span>;
</code></pre><h3 id="WHERE">WHERE</h3><p>WHERE语句就像个过滤器：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Orders <span class="keyword">WHERE</span> Customer=<span class="string">"Smith"</span>;
mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Orders <span class="keyword">WHERE</span> Customer <span class="keyword">LIKE</span> <span class="string">"B%"</span>;
</code></pre><h3 id="移除重复项">移除重复项</h3><p><code>DISTINCT</code>从结果中选择唯一的结果集。</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Customer <span class="keyword">FROM</span> Orders <span class="keyword">WHERE</span> Customer <span class="keyword">LIKE</span> <span class="comment">'B%';</span>
</code></pre><p><code>COUNT</code>函数统计个数</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> COUNT(Customer) <span class="keyword">AS</span> <span class="string">"Orders by Brown"</span> <span class="keyword">FROM</span> Orders <span class="keyword">WHERE</span> Customer=<span class="string">"Brown"</span>;
</code></pre><h2 id="聚合数据">聚合数据</h2><p><code>GROUP BY</code>语句被用来结合值一样的数据库记录到一个单一的记录中。通常和聚合函数一起使用。</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> SUM(OrderPrice) <span class="keyword">AS</span> Total, Customer <span class="keyword">FROM</span> Orders <span class="keyword">GROUP</span> <span class="keyword">BY</span> Customer;
</code></pre><p>使用聚合函数时不能使用<code>WHERE</code>而是使用<code>HAVING</code>：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> <span class="keyword">SUM</span>(OrderPrice) AS Total, Customer FROM Orders
    <span class="subst">-&gt; </span><span class="keyword">GROUP</span> <span class="keyword">BY</span> Customer HAVING <span class="keyword">SUM</span>(OrderPrice)&gt;<span class="number">1000</span>;
</code></pre><h3 id="选择内容到文件">选择内容到文件</h3><p><code>SELECT</code>语句能被用来写入表到文件中：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">INTO</span> OUTFILE <span class="string">'/tmp/cars.txt'</span>
    <span class="subst">-&gt; </span>FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">','</span>
    <span class="subst">-&gt; </span>LINES TERMINATED <span class="keyword">BY</span> <span class="string">'\n'</span>
    <span class="subst">-&gt; </span>FROM Cars;
</code></pre><h2 id="子查询">子查询</h2><p>又称嵌套查询，可以和<code>INSERT</code>、<code>SELECT</code>、<code>UPDATE</code>和<code>DELETE</code>配合使用：</p>
<pre><code>mysql&gt; INSERT <span class="keyword">INTO</span> Cars2 <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars;
mysql&gt; <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Customers <span class="keyword">WHERE</span> 
-&gt; CustomerId=(<span class="keyword">SELECT</span> CustomerId <span class="keyword">FROM</span> Reservations <span class="keyword">WHERE</span> Id=<span class="number">5</span>);
mysql&gt; <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Customers <span class="keyword">WHERE</span> CustomerId <span class="keyword">IN</span>    
-&gt; (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> CustomerId <span class="keyword">FROM</span> Reservations);
mysql&gt; <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Cost &lt;
-&gt; (<span class="keyword">SELECT</span> AVG(Cost) <span class="keyword">FROM</span> Cars);
</code></pre><p><code>EXISTS</code>和<code>NOT EXISTS</code>：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Customers <span class="keyword">WHERE</span> EXISTS
-&gt; (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Reservations <span class="keyword">WHERE</span>
-&gt; Customers.CustomerId=Reservations.CustomerId);
mysql&gt; <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Customers <span class="keyword">WHERE</span> <span class="keyword">NOT</span> EXISTS    
-&gt; (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Reservations <span class="keyword">WHERE</span> 
-&gt; Customers.CustomerId=Reservations.CustomerId);
</code></pre><h2 id="限制">限制</h2><p>限制用来限定列的类型。</p>
<p><code>NOT NULL</code>：</p>
<pre><code>mysql&gt; CREATE TABLE People(Id <span class="built_in">INTEGER</span>, LastName <span class="keyword">TEXT</span> <span class="keyword">NOT</span> NULL,
-&gt;                     FirstName <span class="keyword">TEXT</span> <span class="keyword">NOT</span> NULL, City VARCHAR(<span class="number">55</span>));
</code></pre><p><code>UNIQUE</code>：</p>
<pre><code>mysql&gt; CREATE TABLE Brands<span class="list">(<span class="keyword">Id</span> INTEGER, BrandName VARCHAR<span class="list">(<span class="number">30</span>)</span> UNIQUE)</span><span class="comment">;</span>
</code></pre><p><code>PRIMARY KEY</code>自动拥有<code>UNIQUE</code>和<code>NOT NULL</code>：</p>
<pre><code>mysql&gt; CREATE TABLE Brands<span class="list">(<span class="keyword">Id</span> INTEGER PRIMARY KEY, BrandName VARCHAR<span class="list">(<span class="number">30</span>)</span> UNIQUE)</span><span class="comment">;</span>
</code></pre><p><code>FOREIGN KEY</code>是指向另一个表主键的索引，用来联系两个表：</p>
<pre><code>mysql&gt; CREATE TABLE Books<span class="list">(<span class="keyword">BookId</span> INTEGER PRIMARY KEY, Title VARCHAR<span class="list">(<span class="number">50</span>)</span>,
    -&gt; AuthorId INTEGER, FOREIGN KEY<span class="list">(<span class="keyword">AuthorId</span>)</span> REFERENCES Authors<span class="list">(<span class="keyword">AuthorId</span>)</span>)</span>
    -&gt; type=InnoDB<span class="comment">;</span>
</code></pre><p><code>ENUM</code>可以是列出中的一个：</p>
<pre><code>mysql&gt; CREATE TABLE Shops<span class="list">(<span class="keyword">Id</span> INTEGER, Name VARCHAR<span class="list">(<span class="number">55</span>)</span>, 
    -&gt; Quality ENUM<span class="list">(<span class="quoted">'High</span>', <span class="quoted">'Average</span>', <span class="quoted">'Low</span>')</span>)</span><span class="comment">;</span>
</code></pre><p><code>SET</code>可以是零个或多个：</p>
<pre><code>mysql&gt; CREATE TABLE Students<span class="list">(<span class="keyword">Id</span> INTEGER, Name VARCHAR<span class="list">(<span class="number">55</span>)</span>, 
    -&gt; Certificates SET<span class="list">(<span class="quoted">'A1</span>', <span class="quoted">'A2</span>', <span class="quoted">'B1</span>', <span class="quoted">'C1</span>')</span>)</span><span class="comment">; </span>
</code></pre><p>注意插入时<code>Certificates</code>列的值用括号括起来，之间用逗号分隔且不能有空格。</p>
<pre><code>mysql&gt; INSERT INTO <span class="function">Students <span class="title">VALUES</span><span class="params">(<span class="number">3</span>, <span class="string">'Mark'</span>, <span class="string">'A1,A2,D1,D2'</span>)</span></span>;
</code></pre><h2 id="导出和导入数据">导出和导入数据</h2><p>简单导出到文件和导入到数据库：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">INTO</span> OUTFILE <span class="comment">'/tmp/cars';  # 空格分隔</span>
mysql&gt; LOAD DATA INFILE <span class="comment">'/tmp/cars.csv' INTO TABLE Cars</span>
-&gt; FIELDS TERMINATED <span class="keyword">BY</span> <span class="comment">',';</span>
</code></pre><p>导入到xml文件：</p>
<pre><code>$ mysql -uroot -p --<span class="keyword">xml</span> <span class="title">-e</span> 'SELECT * FROM mydb.Cars' &gt; /tmp/cars.<span class="keyword">xml</span>
<span class="title">mysql</span>&gt; LOAD <span class="keyword">XML</span> <span class="title">/tmp</span>/cars.<span class="keyword">xml</span> <span class="title">INTO</span> TABLE Cars;
</code></pre><p>使用mysqldump工具：</p>
<p>只保存数据结构：</p>
<pre><code>$ mysqldump -<span class="keyword">u</span> root -p --<span class="keyword">no</span>-data mydb &gt; bkp1.sql
</code></pre><p>只保存数据</p>
<pre><code>$ mysqldump -uroot -<span class="tag">p</span> --no-create-info mydb &gt; bkp2.sql
</code></pre><p>完整数据库</p>
<pre><code>$ mysqldump -uroot -<span class="tag">p</span> mydb &gt; bkp3.sql
</code></pre><p>恢复数据：</p>
<pre><code>mysql&gt; CREATE DATABASE mydb<span class="comment">;</span>
mysql&gt; USE mydb<span class="comment">;</span>
mysql&gt; source bkp3.sql
</code></pre><h2 id="连接表">连接表</h2><h3 id="内连接">内连接</h3><p>分<code>INNER JOIN</code>、<code>NATURAL INNER JOIN</code>和<code>CROSS INNER JOIN</code>三种， <code>INNER</code>关键字可省略。以下是<code>INNER JOIN</code></p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> Name, Day <span class="keyword">FROM</span> Customers <span class="keyword">AS</span> C <span class="keyword">JOIN</span> Reservations 
    -&gt; <span class="keyword">AS</span> R <span class="keyword">ON</span> C.CustomerId=R.CustomerId;
mysql&gt; <span class="keyword">SELECT</span> Name, Day <span class="keyword">FROM</span> Customers, Reservations
    -&gt; <span class="keyword">WHERE</span> Customers.CustomerId=Reservations.CustomerId;
</code></pre><p><code>CROSS JOIN</code>是两个表的笛卡尔乘积。</p>
<pre><code>mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Day <span class="keyword">FROM</span> Customers CROSS <span class="built_in">JOIN</span> Reservations;
mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Day <span class="keyword">FROM</span> Customers, Reservations;
</code></pre><h3 id="外连接">外连接</h3><p>左内连，选取左边所有的值：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> Name, <span class="built_in">Day</span> FROM Customers <span class="built_in">LEFT</span> <span class="built_in">JOIN</span> Reservations
    -&gt; <span class="keyword">ON</span> Customers.CustomerId=Reservations.CustomerId;
mysql&gt; <span class="keyword">SELECT</span> Name, <span class="built_in">Day</span> FROM Customers <span class="built_in">LEFT</span> <span class="built_in">JOIN</span> Reservations
    -&gt; USING (CustomerId);
</code></pre><p>右内连，同上，孤单的右边值对应的左边为<code>NULL</code></p>
<pre><code>mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Day <span class="keyword">FROM</span> Customers RIGHT <span class="built_in">JOIN</span>
    -&gt; Reservations USING (CustomerId);
</code></pre><p>自然连，会把所有列连在一起：</p>
<pre><code>mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Day <span class="keyword">FROM</span> Customers NATURAL <span class="built_in">JOIN</span> Reservations;
mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Day <span class="keyword">FROM</span> Customers 
    -&gt; NATURAL LEFT <span class="built_in">JOIN</span> Reservations;
mysql&gt; <span class="built_in">SELECT</span> <span class="built_in">Name</span>, Day <span class="keyword">FROM</span> Customers
    -&gt; NATURAL RIGHT <span class="built_in">JOIN</span> Reservations;
</code></pre><h2 id="MySQL函数">MySQL函数</h2><h3 id="数学函数">数学函数</h3><pre><code>mysql&gt; <span class="tag">SELECT</span> <span class="function">RAND</span>(), <span class="function">ABS</span>(-3), <span class="function">PI</span>(), <span class="function">SIN</span>(0<span class="class">.5</span>),
     &gt; <span class="function">BIN</span>(22), <span class="function">OCT</span>(22), <span class="function">HEX</span>(22)
     &gt; <span class="function">CEIL</span>(11<span class="class">.256</span>), <span class="function">FLOOR</span>(11<span class="class">.256</span>), <span class="function">ROUND</span>(11<span class="class">.256</span>, 2),
     &gt; <span class="function">POW</span>(3, 3), <span class="function">SQRT</span>(9),
     &gt; <span class="function">DEGREES</span>(2*<span class="function">PI</span>());
</code></pre><h3 id="聚合函数">聚合函数</h3><pre><code>mysql&gt; SELECT MIN<span class="function"><span class="params">(Cost)</span>, <span class="title">MAX</span><span class="params">(Cost)</span>, <span class="title">AVG</span><span class="params">(Cost)</span>
    -&gt;</span> FROM Cars;
mysql&gt; SELECT SUM(Cost), COUNT(Id), STD(Cost),<span class="function"> 
    -&gt;</span> VARIANCE(Cost) FROM Cars;
</code></pre><h3 id="字符串函数">字符串函数</h3><pre><code>mysql&gt; <span class="keyword">SELECT</span> LENGTH(<span class="string">'ZetCode'</span>), UPPER(<span class="string">'ZetCode'</span>), LOWER(<span class="string">'ZetCode'</span>);
mysql&gt; <span class="keyword">SELECT</span> LPAD(RPAD(<span class="string">"ZetCode"</span>, <span class="number">10</span>, <span class="string">"*"</span>), <span class="number">13</span>, <span class="string">"*"</span>);
mysql&gt; <span class="keyword">SELECT</span> REVERSE(<span class="string">'ZetCode'</span>), REPEAT(<span class="string">'*'</span>, <span class="number">6</span>);
mysql&gt; <span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(<span class="string">'ZetCode'</span>, <span class="number">3</span>), <span class="keyword">RIGHT</span>(<span class="string">'ZetCode'</span>, <span class="number">3</span>), 
    -&gt; SUBSTRING(<span class="string">'ZetCode'</span>, <span class="number">3</span>, <span class="number">3</span>);
mysql&gt; <span class="keyword">SELECT</span> STRCMP(<span class="string">'byte'</span>, <span class="string">'byte'</span>), CONCAT(<span class="string">'three'</span>, <span class="string">' apples'</span>);
mysql&gt; <span class="keyword">SELECT</span> REPLACE(<span class="string">'basketball'</span>, <span class="string">'basket'</span>, <span class="string">'foot'</span>);
</code></pre><h3 id="日期时间函数">日期时间函数</h3><pre><code>mysql&gt; <span class="keyword">SELECT</span> <span class="keyword">DAYNAME</span>(<span class="string">'2011-01-23'</span>), <span class="keyword">YEAR</span>(<span class="string">'2011/01/23'</span>),
    -&gt; <span class="keyword">MONTHNAME</span>(<span class="string">'110123'</span>);
mysql&gt; <span class="keyword">SELECT</span> NOW();
mysql&gt; <span class="keyword">SELECT</span> CURTIME(), CURDATE();
mysql&gt; <span class="keyword">SELECT</span> DATEDIFF(<span class="string">'2011-3-12'</span>, <span class="string">'2011-1-12'</span>);
mysql&gt; <span class="keyword">SELECT</span> WEEKOFYEAR(<span class="string">'110123'</span>), <span class="keyword">WEEKDAY</span>(<span class="string">'110123'</span>),
    -&gt; QUARTER(<span class="string">'110123'</span>);
mysql&gt; <span class="keyword">SELECT</span> DATE_FORMAT(<span class="string">'110123'</span>, <span class="string">'%d-%m-%Y'</span>);
mysql&gt; <span class="keyword">SELECT</span> DATE_ADD(<span class="string">'110123'</span>, INTERVAL <span class="number">45</span> <span class="keyword">DAY</span>), 
    -&gt; SUBDATE(<span class="string">'110309'</span>, INTERVAL <span class="number">45</span> <span class="keyword">DAY</span>);
</code></pre><h3 id="系统函数">系统函数</h3><pre><code>mysql&gt; <span class="keyword">SELECT</span> VERSION(), DATABASE()<span class="comment">;</span>
mysql&gt; <span class="keyword">SELECT</span> USER()<span class="comment">;</span>
mysql&gt; <span class="keyword">SELECT</span> CHARSET(<span class="string">'ZetCode'</span>), COLLATION(<span class="string">'ZetCode'</span>)<span class="comment">;</span>
</code></pre><h2 id="MySQL视图">MySQL视图</h2><p>视图是一种从表中切取的特殊伪表。有以下限制：</p>
<ul>
<li><code>SELECT</code>不能包含子查询</li>
<li><code>SELECT</code>语句不能指向系统或用户变量</li>
<li>在定义中指向的任何表或视图必须存在</li>
<li>不能创建临时视图</li>
<li>一个视图不能被触发关联。</li>
</ul>
<p>创建、更改和删除视图：</p>
<pre><code>mysql&gt; CREATE VIEW CheapCars <span class="keyword">AS</span> 
    -&gt; <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Cost&lt;<span class="number">25000</span>;
mysql&gt; ALTER VIEW CheapCars <span class="keyword">AS</span> <span class="keyword">SELECT</span> Name <span class="keyword">FROM</span> Cars
    -&gt; <span class="keyword">WHERE</span> Cost&lt;<span class="number">30000</span>;
mysql&gt; DROP VIEW CheapCars;
</code></pre><p>找到视图：</p>
<pre><code>mysql&gt; SHOW FULL TABLES;
mysql&gt; <span class="keyword">SELECT</span> TABLE_NAME, TABLE_TYPE <span class="keyword">FROM</span> information_schema.TABLES;
mysql&gt; <span class="keyword">SELECT</span> TABLE_NAME <span class="keyword">FROM</span> information_schema.VIEWS;
</code></pre><p><code>UNION</code>被用来结合两个或更多<code>SELECT</code>语句得到的结果集，可以通过<code>UNION</code>创建视图</p>
<pre><code>mysql&gt; CREATE VIEW FavoriteCars <span class="keyword">AS</span>
    -&gt; <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Id=<span class="number">7</span>
    -&gt; UNION <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Id=<span class="number">4</span>
    -&gt; UNION <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> Cars <span class="keyword">WHERE</span> Id=<span class="number">5</span>;
</code></pre><h2 id="事务">事务</h2><p>数据库并发操作控制单位。这些操作可以commit可以回滚。</p>
<p>解释下ACID。</p>
<h3 id="隔离级">隔离级</h3><ul>
<li>序列，一个接一个</li>
<li>重复读，读的时候其它事务没提交就没法修改，改的时候没提交其它事务就没法读，默认级别。</li>
<li>读提交。</li>
<li>读未提交。</li>
</ul>
<ol>
<li>脏读(事务没提交，提前读取)：脏读就是指当一个事务正在访问数据，并且对数据进行了修改，而这种修改还没有提交到数据库中，这时，另外一个事务也访问这个数据，然后使用了这个数据。 </li>
<li>不可重复读(两次读的不一致) ：是指在一个事务内，多次读同一数据。在这个事务还没有结束时，另外一个事务也访问该同一数据。那么，在第一个事务中的两次读数据之间，由于第二个事务的修改，那么第一个事务两次读到的的数据可能是不一样的。这样就发生了在一个事务内两次读到的数据是不一样的，因此称为是不可重复读。例如，一个编辑人员两次读取同一文档，但在两次读取之间，作者重写了该文档。当编辑人员第二次读取文档时，文档已更改。原始读取不可重复。如果只有在作者全部完成编写后编辑人员才可以读取文档，则可以避免该问。</li>
<li>幻读 : 是指当事务不是独立执行时发生的一种现象，例如第一个事务对一个表中的数据进行了修改，这种修改涉及到表中的全部数据行。同时，第二个事务也修改这个表中的数据，这种修改是向表中插入一行新数据。那么，以后就会发生操作第一个事务的用户发现表中还有没有修改的数据行，就好象发生了幻觉一样。例如，一个编辑人员更改作者提交的文档，但当生产部门将其更改内容合并到该文档的主复本时，发现作者已将未编辑的新材料添加到该文档中。如果在编辑人员和生产部门完成对原始文档的处理之前，任何人都不能将新材料添加到文档中，则可以避免该问题。 </li>
</ol>
<p>默认隔离级和可能出现情况：</p>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>Phantom read</th>
<th>Nonrepeatable read</th>
<th>Dirty read</th>
</tr>
</thead>
<tbody>
<tr>
<td>序列化</td>
<td>不可能</td>
<td>不可能</td>
<td>不可能</td>
</tr>
<tr>
<td>可重读</td>
<td>可能</td>
<td>不可能</td>
<td>不可能</td>
</tr>
<tr>
<td>读提交</td>
<td>可能</td>
<td>可能</td>
<td>不可能</td>
</tr>
<tr>
<td>读未提交</td>
<td>可能</td>
<td>可能</td>
<td>可能</td>
</tr>
</tbody>
</table>
<p>查看和选择隔离级别</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> @<span class="constant">@tx_isolation</span><span class="comment">;</span>
mysql&gt; SET TRANSACTION ISOLATION LEVEL SERIALIZABLE<span class="comment">;</span>
</code></pre><h3 id="自动提交">自动提交</h3><p>MySQL会自动提交不以<code>START</code>开头的<code>UPDATE</code>和<code>INSERT</code>语句。查看和设置当前设置：</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> @<span class="constant">@autocommit</span><span class="comment">;</span>
mysql&gt; SET autocommit=<span class="number">0</span><span class="comment">;</span>
</code></pre><p>提交后的状态无法回滚。<code>ROLLBACK</code></p>
<h3 id="开始事务">开始事务</h3><p>自动提交的命令会被MySQL封装为一个单独的事务。我们也可以用<code>START</code>语句实现。</p>
<pre><code>mysql&gt; <span class="literal">START</span> TRANSACTION;
</code></pre><p>之后可以执行命令提交或者回滚：</p>
<p>提交</p>
<pre><code>mysql&gt; INSERT <span class="keyword">INTO</span> <span class="keyword">Test</span> VALUES (<span class="number">5</span>), (<span class="number">6</span>)<span class="comment">;</span>
mysql&gt; INSERT <span class="keyword">INTO</span> <span class="keyword">Test</span> VALUES (<span class="number">7</span>), (<span class="number">8</span>)<span class="comment">;</span>
mysql&gt; COMMIT<span class="comment">;</span>
</code></pre><p>回滚</p>
<pre><code>mysql&gt; INSERT <span class="keyword">INTO</span> <span class="keyword">Test</span> VALUES (<span class="number">5</span>), (<span class="number">6</span>)<span class="comment">;</span>
mysql&gt; INSERT <span class="keyword">INTO</span> <span class="keyword">Test</span> VALUES (<span class="number">7</span>), (<span class="number">8</span>)<span class="comment">;</span>
mysql&gt; ROLLBACK<span class="comment">;</span>
</code></pre><h2 id="在MySQL中存储例程">在MySQL中存储例程</h2><p>在MySQL中存在两种存储例程，一种是过程，一种是函数。</p>
<p>过程用<code>CALL</code>调用，不返回值。函数通过<code>SELECT</code>使用，返回值。</p>
<p>过程存储有利有弊。</p>
<h3 id="一个简单过程">一个简单过程</h3><p>创建<code>AllCars</code>g过程选取<code>Cars</code>表中所有内容：</p>
<pre><code>mysql&gt; <span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">AllCars</span><span class="params">()</span> <span class="title">SELECT</span> * <span class="title">FROM</span> <span class="title">Cars</span>;</span>
mysql&gt; CALL AllCars();
</code></pre><h3 id="一个简单函数">一个简单函数</h3><p>定义过程和函数最好的方法是一个单独的sql文件。以下是创建了一个<code>sql</code>文件。通过<code>CREATE FUNCTION</code>创建函数，通过<code>SELECT</code>语句调用。</p>
<pre><code><span class="comment">-- this function computes the area</span>
<span class="comment">-- of a circle; it takes a radius as</span>
<span class="comment">-- a parameter</span>

DELIMITER $$

<span class="operator"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> CircleArea;</span>

<span class="operator"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> CircleArea(r <span class="keyword">DOUBLE</span>) <span class="keyword">RETURNS</span> <span class="keyword">DOUBLE</span>
<span class="keyword">BEGIN</span>
    <span class="keyword">DECLARE</span> area <span class="keyword">DOUBLE</span>;</span>

    <span class="operator"><span class="keyword">SET</span> area = r * r * <span class="keyword">pi</span>();</span>
    RETURN area;
<span class="operator"><span class="keyword">END</span> 

$$

DELIMITER ;</span>
</code></pre><p>函数调用：</p>
<pre><code>mysql&gt; source circlearea.sql
mysql&gt; <span class="function">SELECT <span class="title">CircleArea</span><span class="params">(<span class="number">5.5</span>)</span></span>;
</code></pre><h3 id="过程参数">过程参数</h3><p>有三种参数内型：</p>
<ul>
<li>IN，传递给过程，只能在函数内修改</li>
<li>OUT，输出参数，并不从外部传递给过程</li>
<li>INOUT，混合内型，可以传递给过程来更改也可以在过程外部存取。</li>
</ul>
<p>在sql文件中定义过程：</p>
<pre><code>-- this <span class="function"><span class="keyword">procedure</span> <span class="title">computes</span> <span class="title">the</span> <span class="title">power</span> 
-- <span class="title">of</span> <span class="title">a</span> <span class="title">given</span> <span class="title">value</span>

<span class="title">DELIMITER</span> $$

<span class="title">DROP</span> <span class="title">PROCEDURE</span> <span class="title">IF</span> <span class="title">EXISTS</span> <span class="title">Pow</span>;</span>

<span class="keyword">CREATE</span> <span class="function"><span class="keyword">PROCEDURE</span> <span class="title">Pow</span><span class="params">(<span class="keyword">IN</span> val DOUBLE, <span class="keyword">OUT</span> p DOUBLE)</span> 
<span class="title">BEGIN</span>
    <span class="title">SET</span> <span class="title">p</span> = <span class="title">val</span> * <span class="title">val</span>;</span>
<span class="keyword">END</span> 

$$

DELIMITER ;
</code></pre><p>调用：</p>
<pre><code>mysql&gt; source power.sql

mysql&gt; <span class="built_in">CALL</span> Pow(<span class="number">3</span>, <span class="constant">@p</span>)<span class="comment">;</span>

mysql&gt; <span class="keyword">SELECT</span> <span class="constant">@p</span><span class="comment">;</span>
</code></pre><h3 id="找到过程或函数">找到过程或函数</h3><p>通过<code>SHOW PROCEDURE STATUS</code>和<code>SHOW FUNCTION STATUS</code>查看。</p>
<p>或者</p>
<pre><code>mysql&gt; <span class="keyword">SELECT</span> SPECIFIC_NAME from information_schema<span class="built_in">.</span>ROUTINES  
    <span class="subst">-&gt; </span><span class="keyword">WHERE</span> ROUTINE_TYPE=<span class="string">'PROCEDURE'</span>;
mysql&gt; <span class="keyword">SELECT</span> SPECIFIC_NAME from information_schema<span class="built_in">.</span>ROUTINES 
    <span class="subst">-&gt; </span><span class="keyword">WHERE</span> ROUTINE_TYPE=<span class="string">'FUNCTION'</span>;
</code></pre><h2 id="MySQL_C_API">MySQL C API</h2><p>MySQL有个C API</p>
<p>debian上要装这个：</p>
<pre><code>$ sudo apt-<span class="built_in">get</span> install libmysqlclient-<span class="built_in">dev</span>
</code></pre><p>我们只要在头文件中包含<code>mysql.h</code>，编译时以以下方式编译：</p>
<pre><code>$ gcc <span class="property">version</span>.c -o <span class="property">version</span>  `mysql_config <span class="comment">--cflags --libs`</span>
</code></pre><p>基本步骤是先初始化连接：</p>
<pre><code>MYSQL *con = mysql_init(<span class="literal">NULL</span>);

<span class="keyword">if</span> (con == <span class="literal">NULL</span>) 
{
    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"%s\n"</span>, mysql_error(con));
    <span class="built_in">exit</span>(<span class="number">1</span>);
}
</code></pre><p>再真的连到服务器或某个数据库中：</p>
<pre><code><span class="keyword">if</span> (mysql_real_connect(con, <span class="string">"localhost"</span>, <span class="string">"root"</span>, <span class="string">"root_pswd"</span>, 
        <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="number">0</span>) == <span class="literal">NULL</span>) 
{
    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"%s\n"</span>, mysql_error(con));
    mysql_close(con);
    <span class="built_in">exit</span>(<span class="number">1</span>);
}
</code></pre><p>执行操作：</p>
<pre><code><span class="keyword">if</span> (mysql_query(con, <span class="string">"CREATE DATABASE testdb"</span>)) 
{
    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"%s\n"</span>, mysql_error(con));
    mysql_close(con);
    <span class="built_in">exit</span>(<span class="number">1</span>);
}
</code></pre><p>取回数据：</p>
<pre><code><span class="type">MYSQL_RES</span> *<span class="literal">result</span> = mysql_store_result(con);

<span class="keyword">if</span> (<span class="literal">result</span> == <span class="type">NULL</span>) 
{
    finish_with_error(con);
}

<span class="type">int</span> num_fields = mysql_num_fields(<span class="literal">result</span>);

<span class="type">MYSQL_ROW</span> row;

<span class="keyword">while</span> ((row = mysql_fetch_row(<span class="literal">result</span>))) 
{ 
    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; num_fields; i++) 
    { 
        printf(<span class="string">"%s "</span>, row[i] ? row[i] : <span class="string">"NULL"</span>); 
    } 
        printf(<span class="string">"\n"</span>); 
}

mysql_free_result(<span class="literal">result</span>);
</code></pre><p>还有些其它函数，参考<a href="http://dev.mysql.com/doc/refman/5.1/zh/apis.html" target="_blank" rel="external">http://dev.mysql.com/doc/refman/5.1/zh/apis.html</a></p>

    
  </div>
</article>

</div>


  
      <div class="fexo-comments comments-post">
    
  <section class="disqus-comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>

  <script>
    var disqus_shortname = 'reverlandblog';
    
    var disqus_url = 'http://reverland.org/sql/2014/05/31/mysql-learning-notes/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>


    




  </div>

  

</body>
</html>
