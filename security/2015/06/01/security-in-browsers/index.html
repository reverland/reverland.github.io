<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Security in Browsers | Reverland的行知阁</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="browser,security," />
  

  <meta name="description" content="同源策略同源策略限制来自某个源的文档或者脚本与另一个源的资源交互。同源策略用来阻止一些CSRF攻击。
定义协议+端口(如果指定)+主机都相同。
继承源来自about:blank，javascript:和data:的URL内容继承加载这个文档的URL的源，因为它自身并没有关于源的信息。
IE特例IE有两个关于同源策略的例外：

信任区域(Trust Zones):如果两个域名高度互信，比如同一个公司">
<meta property="og:type" content="article">
<meta property="og:title" content="Security in Browsers">
<meta property="og:url" content="http://reverland.org/security/2015/06/01/security-in-browsers/index.html">
<meta property="og:site_name" content="Reverland的行知阁">
<meta property="og:description" content="同源策略同源策略限制来自某个源的文档或者脚本与另一个源的资源交互。同源策略用来阻止一些CSRF攻击。
定义协议+端口(如果指定)+主机都相同。
继承源来自about:blank，javascript:和data:的URL内容继承加载这个文档的URL的源，因为它自身并没有关于源的信息。
IE特例IE有两个关于同源策略的例外：

信任区域(Trust Zones):如果两个域名高度互信，比如同一个公司">
<meta property="og:updated_time" content="2015-11-15T06:01:31.559Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Security in Browsers">
<meta name="twitter:description" content="同源策略同源策略限制来自某个源的文档或者脚本与另一个源的资源交互。同源策略用来阻止一些CSRF攻击。
定义协议+端口(如果指定)+主机都相同。
继承源来自about:blank，javascript:和data:的URL内容继承加载这个文档的URL的源，因为它自身并没有关于源的信息。
IE特例IE有两个关于同源策略的例外：

信任区域(Trust Zones):如果两个域名高度互信，比如同一个公司">

  

  
    <link rel="icon" href="/images/favicon.ico">
  

  <link rel="stylesheet" href="/css/styles.css" type="text/css">

  

  

  

</head>

<body>
  <div class="post-header CENTER">
   
  <div class="toolbox">
    <div class="toolbox-entry">盒子</div>
    <ul class="list-toolbox">
      
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/archives/">博客</a>
          </li>
        
      
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/category/">分类</a>
          </li>
        
      
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/tag/">标签</a>
          </li>
        
      
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/link/">友链</a>
          </li>
        
      
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/about/">关于</a>
          </li>
        
      
        
          <li class="item-toolbox">
            <a class="CIRCLE" href="/atom.xml">RSS</a>
          </li>
        
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#同源策略"><span class="toc-text">同源策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定义"><span class="toc-text">定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#继承源"><span class="toc-text">继承源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IE特例"><span class="toc-text">IE特例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变更源"><span class="toc-text">变更源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#跨域网络访问"><span class="toc-text">跨域网络访问</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#如何允许跨域访问"><span class="toc-text">如何允许跨域访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#如何阻止跨域访问"><span class="toc-text">如何阻止跨域访问</span></a></li></ol></li></ol></li></ol>
  </div>


<div class="content-post CENTER">
   <article id="post-security-in-browsers" class="article article-type-post" itemscope itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">Security in Browsers</h1>

    <div class="article-meta">
      <span>2015-06-01</span>

      <span> | </span>

      <span class="article-author">Liu Yuyang</span>

      <span> | </span>

      
  <span class="article-category">
    <a class="article-category-link" href="/categories/security/">security</a>
  </span>


    </div>
  </header>

  <div class="article-content">
    
      <h2 id="同源策略">同源策略</h2><p>同源策略限制来自某个源的文档或者脚本与另一个源的资源交互。同源策略用来阻止一些CSRF攻击。</p>
<h3 id="定义">定义</h3><p>协议+端口(如果指定)+主机都相同。</p>
<h4 id="继承源">继承源</h4><p>来自<code>about:blank</code>，<code>javascript:</code>和<code>data:</code>的URL内容继承加载这个文档的URL的源，因为它自身并没有关于源的信息。</p>
<h4 id="IE特例">IE特例</h4><p>IE有两个关于同源策略的例外：</p>
<ol>
<li>信任区域(Trust Zones):如果两个域名高度互信，比如同一个公司域名，不使用同源策略。</li>
<li>端口：IE的同源策略不考虑端口。</li>
</ol>
<h3 id="变更源">变更源</h3><p>更改页面的源受到限制。脚本可以把<code>document.domain</code>设成当前domain的子集。之后就以此可以作为同源检查的源。例如，页面<code>http://store.company.com/dir/other.html</code>上的脚本可以这样：</p>
<pre><code>document<span class="class">.domain</span> = <span class="string">"company.com"</span>
</code></pre><p>注意必要时要指定端口号，否则会被赋值成null。</p>
<p>让子域安全访问父域必须将两者的<code>document.domain</code>设置为相同。</p>
<h3 id="跨域网络访问">跨域网络访问</h3><p>同源策略控制两个不同源的交互，当使用<code>XMLHttpRequest</code>或者<code>img</code>标签时。这些交互分为3类：</p>
<ol>
<li>跨域<code>写入</code>通常是允许的。例如链接(links)，重定向(redirects)和表单提交。某些罕见的HTTP请求需要<code>preflight</code>。</li>
<li>跨域嵌入通常是允许的。例子如下</li>
<li>跨域读取通常不允许，但通常通过嵌入泄漏了不可读内容。例如你可以读到嵌入图像的长宽，嵌入脚本的行为，或者<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=629094" target="_blank" rel="external">嵌入资源的可访问性</a>。</li>
</ol>
<p>以下是一些跨域嵌入的例子：</p>
<ul>
<li>通过<code>&lt;script src=&quot;...&quot;&gt;&lt;/script&gt;</code>嵌入的JS。语法错误信息只能在同源脚本中捕捉到。(然我并不理解，只看到浏览器可以捕捉到引入脚本的语法错误)</li>
<li>通过<code>&lt;link rel=&quot;stylesheet&quot; href=&quot;...&quot;&gt;</code>嵌入的CSS。由于CSS松散的语法规则，同源策略要求跨域CSS有正确的<code>Content-Type</code>头。各个浏览器对跨域CSS的限制都不同。</li>
<li>通过<code>&lt;img&gt;</code>嵌入的图像，支持png，jpeg，gif，bmp，svg。。。格式</li>
<li>通过<code>&lt;video&gt;</code>和<code>&lt;audio&gt;</code>嵌入媒体文件。</li>
<li><code>&lt;object&gt;</code>，<code>&lt;embed&gt;</code>和<code>&lt;applet&gt;</code>嵌入的插件。</li>
<li>通过<code>@font-face</code>嵌入的字体。有些浏览器允许跨域字体，有的不行。</li>
<li>任何<code>&lt;iframe&gt;</code>或者<code>&lt;frame&gt;</code>嵌入的东西，网站可以通过设置<code>X-Frame-Options</code>头阻止这种跨域。</li>
</ul>
<h4 id="如何允许跨域访问">如何允许跨域访问</h4><p>使用CORS</p>
<h4 id="如何阻止跨域访问">如何阻止跨域访问</h4>
    
  </div>
</article>



<section class="disqus-comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>




</div>

  
<script>
  var disqus_shortname = 'reverlandblog';
  
  var disqus_url = 'http://reverland.org/security/2015/06/01/security-in-browsers/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"undefined"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0]
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

</body>
</html>
