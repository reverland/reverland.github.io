<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
    <link href='//fonts.lug.ustc.edu.cn/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="network," />





  <link rel="alternate" href="/atom.xml" title="Reverland的行知阁" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/default_avatar.jpg?v=0.4.5.2" />






<meta name="description" content="ICMP协议是IP协议的一部分，虽然它的包被封装在IP包内，好像是IP上层的协议，但它确实是IP协议不可分割的一部分。ICMP协议非常复杂，它用来提供有关网络的消息。
ICMP通常被用来侦查网络。各种ICMP报文甚至可能绕过防火墙探查内网，探测访问控制列表等。
ICMP有时也会被利用来做路由重定向和DDOS等其它用途。
ping和tracerouteping可以用来判断一个ip地址(当提供域名时一">
<meta property="og:type" content="article">
<meta property="og:title" content="Playing and Learning ICMP in Action">
<meta property="og:url" content="http://reverland.org/network/2014/03/15/play-icmp/index.html">
<meta property="og:site_name" content="Reverland的行知阁">
<meta property="og:description" content="ICMP协议是IP协议的一部分，虽然它的包被封装在IP包内，好像是IP上层的协议，但它确实是IP协议不可分割的一部分。ICMP协议非常复杂，它用来提供有关网络的消息。
ICMP通常被用来侦查网络。各种ICMP报文甚至可能绕过防火墙探查内网，探测访问控制列表等。
ICMP有时也会被利用来做路由重定向和DDOS等其它用途。
ping和tracerouteping可以用来判断一个ip地址(当提供域名时一">
<meta property="og:updated_time" content="2015-11-15T06:01:31.523Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Playing and Learning ICMP in Action">
<meta name="twitter:description" content="ICMP协议是IP协议的一部分，虽然它的包被封装在IP包内，好像是IP上层的协议，但它确实是IP协议不可分割的一部分。ICMP协议非常复杂，它用来提供有关网络的消息。
ICMP通常被用来侦查网络。各种ICMP报文甚至可能绕过防火墙探查内网，探测访问控制列表等。
ICMP有时也会被利用来做路由重定向和DDOS等其它用途。
ping和tracerouteping可以用来判断一个ip地址(当提供域名时一">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'post',
    motion: true
  };
</script>

  <title> Playing and Learning ICMP in Action | Reverland的行知阁 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  






  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Reverland的行知阁</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">开放、分享、自由与进步</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Playing and Learning ICMP in Action
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2014-03-15T00:00:00+08:00" content="2014-03-15">
              2014-03-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/network/" itemprop="url" rel="index">
                    <span itemprop="name">network</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/network/2014/03/15/play-icmp/#comments" itemprop="discussionUrl">
                <span class="post-comments-count disqus-comment-count" data-disqus-identifier="network/2014/03/15/play-icmp/" itemprop="commentsCount"></span>
              </a>
            </span>
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><p>ICMP协议是IP协议的一部分，虽然它的包被封装在IP包内，好像是IP上层的协议，但它确实是IP协议不可分割的一部分。ICMP协议非常复杂，它用来提供有关网络的消息。</p>
<p>ICMP通常被用来侦查网络。各种ICMP报文甚至可能绕过防火墙探查内网，探测访问控制列表等。</p>
<p>ICMP有时也会被利用来做路由重定向和DDOS等其它用途。</p>
<h2 id="ping和traceroute">ping和traceroute</h2><p>ping可以用来判断一个ip地址(当提供域名时一般会解析成ip)对应的机器是否在线。</p>
<p>traceroute则为了探测一个包到目的地所经过的路由。</p>
<p><code>ping</code>利用了<code>ICMP echo request</code>和<code>ICMP echo reply</code>。而<code>traceroute</code>则利用了<code>ICMP time-exceeded error message</code>。</p>
<p>我们可以先<code>ping</code>和<code>traceroute</code>来实际看下，</p>
<pre><code> ~ ⮀ ping -c <span class="number">1</span> baidu.com
PING baidu.com (<span class="number">220.181</span><span class="number">.111</span><span class="number">.86</span>) <span class="number">56</span>(<span class="number">84</span>) <span class="keyword">bytes</span> <span class="operator">of</span> data.
<span class="number">64</span> <span class="keyword">bytes</span> <span class="built_in">from</span> <span class="number">220.181</span><span class="number">.111</span><span class="number">.86</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">50</span> <span class="built_in">time</span>=<span class="number">2.07</span> ms

<span class="comment">--- baidu.com ping statistics ---</span>
<span class="number">1</span> packets transmitted, <span class="number">1</span> received, <span class="number">0</span>% packet loss, <span class="built_in">time</span> <span class="number">0</span>ms
rtt <span class="built_in">min</span>/<span class="built_in">avg</span>/<span class="built_in">max</span>/mdev = <span class="number">2.070</span>/<span class="number">2.070</span>/<span class="number">2.070</span>/<span class="number">0.000</span> ms

 ~ ⮀ sudo tcpdump -X <span class="string">"icmp"</span> 
tcpdump: verbose output suppressed, use -v <span class="operator">or</span> -vv <span class="keyword">for</span> full protocol decode
listening <span class="command"><span class="keyword">on</span> <span class="title">eth0</span>, <span class="title">link-type</span> <span class="title">EN10MB</span> (<span class="title">Ethernet</span>), <span class="title">capture</span> <span class="title">size</span> <span class="title">65535</span> <span class="title">bytes</span></span>
<span class="number">18</span>:<span class="number">16</span>:<span class="number">47.917236</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">220.181</span><span class="number">.111</span><span class="number">.86</span>: ICMP echo request, id <span class="number">9095</span>, seq <span class="number">1</span>, <span class="built_in">length</span> <span class="number">64</span>
<span class="number">18</span>:<span class="number">16</span>:<span class="number">47.919293</span> IP <span class="number">220.181</span><span class="number">.111</span><span class="number">.86</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span>: ICMP echo reply, id <span class="number">9095</span>, seq <span class="number">1</span>, <span class="built_in">length</span> <span class="number">64</span>
</code></pre><p>如果用<code>wireshark</code>就能看得更加清楚了，懒得截图。</p>
<p>我们接着看看traceroute是什么样的。</p>
<pre><code> ~ ⮀ <span class="tag">traceroute</span> <span class="tag">bbs</span><span class="class">.byr</span><span class="class">.cn</span>
<span class="tag">traceroute</span> <span class="tag">to</span> <span class="tag">bbs</span><span class="class">.byr</span><span class="class">.cn</span> (10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span>), 30 <span class="tag">hops</span> <span class="tag">max</span>, 60 <span class="tag">byte</span> <span class="tag">packets</span>
 1  10<span class="class">.210</span><span class="class">.96</span><span class="class">.193</span> (10<span class="class">.210</span><span class="class">.96</span><span class="class">.193</span>)  3<span class="class">.360</span> <span class="tag">ms</span>  3<span class="class">.637</span> <span class="tag">ms</span>  3<span class="class">.919</span> <span class="tag">ms</span>
 2  10<span class="class">.2</span><span class="class">.100</span><span class="class">.1</span> (10<span class="class">.2</span><span class="class">.100</span><span class="class">.1</span>)  1<span class="class">.511</span> <span class="tag">ms</span>  1<span class="class">.657</span> <span class="tag">ms</span>  1<span class="class">.825</span> <span class="tag">ms</span>
 3  10<span class="class">.2</span><span class="class">.1</span><span class="class">.1</span> (10<span class="class">.2</span><span class="class">.1</span><span class="class">.1</span>)  1<span class="class">.834</span> <span class="tag">ms</span>  2<span class="class">.422</span> <span class="tag">ms</span>  2<span class="class">.809</span> <span class="tag">ms</span>
 4  10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span> (10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span>)  0<span class="class">.512</span> <span class="tag">ms</span>  0<span class="class">.524</span> <span class="tag">ms</span>  0<span class="class">.531</span> <span class="tag">ms</span>
 5  10<span class="class">.0</span><span class="class">.13</span><span class="class">.2</span> (10<span class="class">.0</span><span class="class">.13</span><span class="class">.2</span>)  1<span class="class">.719</span> <span class="tag">ms</span>  2<span class="class">.021</span> <span class="tag">ms</span>  2<span class="class">.139</span> <span class="tag">ms</span>
 6  10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> (10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span>)  0<span class="class">.946</span> <span class="tag">ms</span>  0<span class="class">.493</span> <span class="tag">ms</span>  0<span class="class">.483</span> <span class="tag">ms</span>

 ~ ⮀ <span class="tag">sudo</span> <span class="tag">tcpdump</span> <span class="tag">-i</span> <span class="tag">eth0</span> "<span class="tag">not</span> <span class="tag">udp</span> <span class="tag">and</span> <span class="tag">not</span> <span class="tag">arp</span>"
<span class="tag">tcpdump</span>: <span class="tag">verbose</span> <span class="tag">output</span> <span class="tag">suppressed</span>, <span class="tag">use</span> <span class="tag">-v</span> <span class="tag">or</span> <span class="tag">-vv</span> <span class="tag">for</span> <span class="tag">full</span> <span class="tag">protocol</span> <span class="tag">decode</span>
<span class="tag">listening</span> <span class="tag">on</span> <span class="tag">eth0</span>, <span class="tag">link-type</span> <span class="tag">EN10MB</span> (<span class="tag">Ethernet</span>), <span class="tag">capture</span> <span class="tag">size</span> 65535 <span class="tag">bytes</span>
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.471441</span> <span class="tag">IP</span> 10<span class="class">.2</span><span class="class">.100</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.471566</span> <span class="tag">IP</span> 10<span class="class">.2</span><span class="class">.100</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472026</span> <span class="tag">IP</span> 10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 36
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472089</span> <span class="tag">IP</span> 10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 36
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472106</span> <span class="tag">IP</span> 10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 36
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472113</span> <span class="tag">IP</span> 10<span class="class">.2</span><span class="class">.100</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472120</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">udp</span> <span class="tag">port</span> 33449 <span class="tag">unreachable</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472207</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">udp</span> <span class="tag">port</span> 33450 <span class="tag">unreachable</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472218</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">udp</span> <span class="tag">port</span> 33451 <span class="tag">unreachable</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472227</span> <span class="tag">IP</span> 10<span class="class">.2</span><span class="class">.1</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 36
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472536</span> <span class="tag">IP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.193</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472756</span> <span class="tag">IP</span> 10<span class="class">.2</span><span class="class">.1</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 36
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.472765</span> <span class="tag">IP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.193</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.473175</span> <span class="tag">IP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.193</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.473192</span> <span class="tag">IP</span> 10<span class="class">.2</span><span class="class">.1</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 36
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.473196</span> <span class="tag">IP</span> 10<span class="class">.0</span><span class="class">.13</span><span class="class">.2</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.473442</span> <span class="tag">IP</span> 10<span class="class">.0</span><span class="class">.13</span><span class="class">.2</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
23<span class="pseudo">:36</span><span class="pseudo">:21</span><span class="class">.473603</span> <span class="tag">IP</span> 10<span class="class">.0</span><span class="class">.13</span><span class="class">.2</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">time</span> <span class="tag">exceeded</span> <span class="tag">in-transit</span>, <span class="tag">length</span> 68
</code></pre><p>可以用<code>wireshark</code>更详细的检查。</p>
<p>我们接着看看其它东西。</p>
<h2 id="ping扫射和广播ICMP">ping扫射和广播ICMP</h2><p>ping扫射会<code>ping</code> 一个网段内所有的主机，判断ip所对应的主机是否在线。速度非常快</p>
<p>先试着一个ping sweep，在LAN下nmap如果不明确禁止，一定会使用arp来ping，所以要看看ICMP如何完成ping就禁用它, 然后抓包。</p>
<pre><code> ~ ⮀ sudo nmap -sP <span class="comment">--disable-arp 10.210.96.0/27</span>

Starting Nmap 6.25 ( http://nmap.org ) at 2014-03-21 19:29 CST
Nmap scan report for 10.210.96.1
Host is up (0.0014s latency).
Nmap scan report for 10.210.96.13
Host is up (0.0023s latency).
Nmap done: 32 IP addresses (2 hosts up) scanned in 1.97 seconds

 ~ ⮀ sudo tcpdump "icmp"
 tcpdump: verbose output suppressed, <span class="operator"><span class="keyword">use</span> -v <span class="keyword">or</span> -vv <span class="keyword">for</span> <span class="keyword">full</span> protocol <span class="keyword">decode</span>
 listening <span class="keyword">on</span> eth0, <span class="keyword">link</span>-<span class="keyword">type</span> EN10MB (Ethernet), capture <span class="keyword">size</span> <span class="number">65535</span> <span class="keyword">bytes</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205871</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.1</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">15450</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205895</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.2</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">39828</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205901</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.3</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">26191</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205907</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.4</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">27927</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205911</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.5</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">40326</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205917</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.6</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">20451</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205923</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.7</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">54339</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205930</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.8</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">662</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205934</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.9</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">44505</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.205940</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.10</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">53250</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.207182</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.1</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span>: ICMP echo reply, <span class="keyword">id</span> <span class="number">15450</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.207295</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.13</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">2073</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.207305</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.14</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">4397</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.209792</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.13</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span>: ICMP echo reply, <span class="keyword">id</span> <span class="number">2073</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.209912</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.17</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">19920</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.209922</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.18</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">34999</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306658</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.21</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">29270</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306681</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.22</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">7671</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306689</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.23</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">9104</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306696</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.24</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">81</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306704</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.25</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">32155</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306712</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.26</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">63858</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306720</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.27</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">26777</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306727</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.28</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">13494</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.306733</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.29</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">44984</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.308869</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.0</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">17227</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.310989</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.11</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">34317</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.311005</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.12</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">61365</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.406811</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.16</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">55350</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.406822</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.19</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">35677</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.406828</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.20</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">65464</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.406835</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.30</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">15331</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.406840</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.31</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">29903</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">07.406864</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.15</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">9883</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307498</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.2</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">62949</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307516</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.3</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">12243</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307524</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.4</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">31452</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307532</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.5</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">31537</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307540</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.6</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">54651</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307549</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.7</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">50610</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307559</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.8</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">62664</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307569</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.9</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">13459</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.307578</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.10</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">62077</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407677</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.14</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">55829</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407686</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.17</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">53285</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407691</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.18</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">21378</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407696</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.21</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">23904</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407701</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.22</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">64314</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407707</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.23</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">27486</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407712</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.24</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">20894</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407717</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.25</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">32853</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.407722</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.26</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">45739</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.507898</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.13</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">11633</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.507952</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.0</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">11677</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.507991</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.15</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">42356</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.507996</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.16</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">49147</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508006</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.20</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">57762</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508014</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.27</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">10613</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508768</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.13</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span>: ICMP echo reply, <span class="keyword">id</span> <span class="number">11633</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508823</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.11</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">61920</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508830</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.12</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">46304</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508835</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.19</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">49607</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508840</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.28</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">1352</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508844</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.29</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">46670</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508860</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.30</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">53472</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508863</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.31</span>: ICMP echo request, <span class="keyword">id</span> <span class="number">58278</span>, seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">8</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.508985</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.19</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">26454</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511101</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.30</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">49439</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511108</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.31</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">20408</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511113</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.0</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">47435</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511132</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.5</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">44739</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511138</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.6</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">62544</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511142</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.7</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">60818</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511153</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.11</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">8734</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.511157</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.12</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">42535</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608151</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.17</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">4191</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608157</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.18</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">60313</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608161</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.20</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">30447</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608165</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.21</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">34293</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608169</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.22</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">45789</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608172</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.23</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">20615</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608175</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.24</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">39416</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.608178</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.25</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">43274</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.610367</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.19</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">37423</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.610545</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.2</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">8441</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.610552</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.3</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">3578</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.610557</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.4</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">3637</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.610560</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.8</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">21670</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.610563</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.9</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">59923</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.610565</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.10</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">44321</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612656</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.0</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">2542</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612681</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.5</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">52004</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612689</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.6</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">50499</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612705</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.7</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">49428</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612725</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.11</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">36</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612732</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.12</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">44368</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612745</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.30</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">34029</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.612750</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.31</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">8416</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708321</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.17</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">22579</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708327</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.18</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">44220</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708331</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.20</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">9032</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708343</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.21</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">35831</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708347</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.22</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">2301</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708350</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.23</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">38652</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708353</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.24</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">48909</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.708356</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.25</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">56868</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.710492</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.26</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">11131</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.710505</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.27</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">21052</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.710515</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.28</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">51363</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.710518</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.29</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">64922</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.710521</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.14</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">38360</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.710527</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.16</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">40280</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.710531</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.15</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">22775</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.712621</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.2</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">14586</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.712632</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.3</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">52979</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.712639</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.4</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">55009</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.712646</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.8</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">48655</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.712652</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.9</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">12270</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.712657</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.10</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">52019</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.811539</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.14</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">38654</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.811554</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.15</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">36060</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.811559</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.16</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">54453</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.811564</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.26</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">58198</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.811569</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.27</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">58807</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.811574</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.28</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">25994</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span>
 <span class="number">19</span>:<span class="number">29</span>:<span class="number">08.811578</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.29</span>: ICMP <span class="keyword">time</span> stamp <span class="keyword">query</span> <span class="keyword">id</span> <span class="number">43528</span> seq <span class="number">0</span>, <span class="keyword">length</span> <span class="number">20</span></span>
</code></pre><p>看样子ping扫射时发了一个<code>ICMP echo request</code>不过瘾，又发了一次<code>ICMP time stamp query</code>。</p>
<p>广播ping也可以试着找出局域网内的机器。但通常windows机器都不会响应，安卓也不会响应地址是广播地址的ICMP echo request。</p>
<p>我们还可以看看广播地址的icmp echo request</p>
<p>如果伪造发送者ip，ping广播地址可以是潜在的DDOS。</p>
<pre><code> ~ ⮀ ping -b <span class="number">192.168</span><span class="number">.1</span><span class="number">.255</span>
WARNING: pinging broadcast address
PING <span class="number">192.168</span><span class="number">.1</span><span class="number">.255</span> (<span class="number">192.168</span><span class="number">.1</span><span class="number">.255</span>) <span class="number">56</span>(<span class="number">84</span>) bytes of data.
<span class="number">64</span> bytes from <span class="number">192.168</span><span class="number">.1</span><span class="number">.102</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">83.8</span> ms
<span class="number">64</span> bytes from <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">87.6</span> ms (DUP!)
</code></pre><p>额……发现两个iphone。。。</p>
<pre><code> ~ ⮀ sudo nmap -sS <span class="number">192.168</span><span class="number">.1</span><span class="number">.102</span>

Starting Nmap <span class="number">6.25</span> ( <span class="string">http:</span><span class="comment">//nmap.org ) at 2014-03-15 14:34 CST</span>
Nmap scan report <span class="keyword">for</span> localhost (<span class="number">192.168</span><span class="number">.1</span><span class="number">.102</span>)
Host is up (<span class="number">0.0040</span>s latency).
Not <span class="string">shown:</span> <span class="number">999</span> closed ports
PORT      STATE SERVICE
<span class="number">62078</span>/tcp open  iphone-sync
MAC <span class="string">Address:</span> <span class="string">F1:</span><span class="string">DD:</span><span class="number">08</span>:<span class="string">AF:</span><span class="string">CB:</span>E9 (Unknown)

Nmap <span class="string">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">41.44</span> seconds

 ~ ⮀ sudo nmap -sS <span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span>

Starting Nmap <span class="number">6.25</span> ( <span class="string">http:</span><span class="comment">//nmap.org ) at 2014-03-15 14:37 CST</span>
Nmap scan report <span class="keyword">for</span> localhost (<span class="number">192.168</span><span class="number">.1</span><span class="number">.107</span>)
Host is up (<span class="number">0.0053</span>s latency).
Not <span class="string">shown:</span> <span class="number">999</span> closed ports
PORT      STATE SERVICE
<span class="number">62078</span>/tcp open  iphone-sync
MAC <span class="string">Address:</span> <span class="number">83</span>:<span class="number">48</span>:<span class="number">4</span><span class="string">C:</span><span class="string">DD:</span><span class="number">5</span><span class="string">B:</span><span class="number">96</span> (Unknown)

Nmap <span class="string">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">42.11</span> seconds
</code></pre><p>但安卓就不对广播ICMP request echo响应了。可以参考著名的<a href="http://althing.cs.dartmouth.edu/local/ICMP_Scanning_v3.0.pdf" target="_blank" rel="external">ICMP Usage in<br> Scanning</a>，很详细的文档，虽然年头早了些。</p>
<h2 id="ICMP_Timestamp_query">ICMP Timestamp query</h2><p>接下来试试timestamp request</p>
<pre><code> ~ ⮀ sudo nmap -sP -PP --disable-arp-ping bbs<span class="class">.byr</span><span class="class">.cn</span>

Starting Nmap <span class="number">6.25</span> ( http:<span class="comment">//nmap.org ) at 2014-03-15 14:48 CST</span>
Nmap scan report <span class="keyword">for</span> bbs<span class="class">.byr</span><span class="class">.cn</span> (<span class="number">123.127</span>.<span class="number">134.62</span>)
Host is up (<span class="number">0.0044s</span> latency).
Nmap done: <span class="number">1</span> IP <span class="tag">address</span> (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.23</span> seconds

<span class="number">15</span>:<span class="number">02</span>:<span class="number">20.679449</span> IP <span class="number">10.109</span>.<span class="number">20.127</span> &gt; <span class="number">10.3</span>.<span class="number">18.66</span>: ICMP <span class="tag">time</span> stamp query id <span class="number">6291</span> seq <span class="number">0</span>, length <span class="number">20</span>
<span class="number">15</span>:<span class="number">02</span>:<span class="number">20.682487</span> IP <span class="number">10.3</span>.<span class="number">18.66</span> &gt; <span class="number">10.109</span>.<span class="number">20.127</span>: ICMP <span class="tag">time</span> stamp reply id <span class="number">6291</span> seq <span class="number">0</span>: org <span class="number">00</span>:<span class="number">00</span>:<span class="number">00.000</span>, recv <span class="number">07</span>:<span class="number">09</span>:<span class="number">19.107</span>, xmit <span class="number">07</span>:<span class="number">09</span>:<span class="number">19.107</span>, length <span class="number">20</span>
</code></pre><p>不是所有的机器都会响应。</p>
<pre><code> ~ ⮀ sudo nmap -<span class="variable">sP</span> -PP <span class="comment">--disable-arp-ping 10.109.20.1</span>

Starting Nmap <span class="number">6.25</span> ( <span class="keyword">http</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2014</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">15</span>:<span class="number">00</span> CST
Note: Host seems down. If <span class="keyword">it</span> is really up, but blocking our ping probes, <span class="keyword">try</span> -Pn
Nmap done: <span class="number">1</span> IP address (<span class="number">0</span> hosts up) scanned <span class="operator">in</span> <span class="number">2.20</span> <span class="built_in">seconds</span>


<span class="number">15</span>:<span class="number">00</span>:<span class="number">53.309360</span> IP <span class="number">10.109</span><span class="number">.20</span><span class="number">.127</span> &gt; <span class="number">10.109</span><span class="number">.20</span><span class="number">.1</span>: ICMP <span class="built_in">time</span> stamp query id <span class="number">48585</span> seq <span class="number">0</span>, <span class="built_in">length</span> <span class="number">20</span>
<span class="number">15</span>:<span class="number">00</span>:<span class="number">54.310449</span> IP <span class="number">10.109</span><span class="number">.20</span><span class="number">.127</span> &gt; <span class="number">10.109</span><span class="number">.20</span><span class="number">.1</span>: ICMP <span class="built_in">time</span> stamp query id <span class="number">60795</span> seq <span class="number">0</span>, <span class="built_in">length</span> <span class="number">20</span>
</code></pre><h2 id="ICMP_address_netmask_request">ICMP address netmask request</h2><p>这是个已经废弃的东西，现在推荐使用dhcp，不过看学校的一些路由器还是支持的</p>
<pre><code> ~ ⮀ sudo nmap -sP -PM <span class="comment">--disable-arp-ping 10.109.20.1</span>

Starting Nmap 6.25 ( http://nmap.org ) at 2014-03-15 14:59 CST
Nmap scan report for 10.109.20.1
Host is up (0.0025s latency).
MAC Address: 00:00:E0:60:00:00 (Hangzhou H3C Technologies Co.)
Nmap done: 1 IP address (1 host up) scanned in 0.16 seconds


✘ ⮀ ~ ⮀ sudo tcpdump -i wlan0 "icmp"
tcpdump: verbose output suppressed, <span class="operator"><span class="keyword">use</span> -v <span class="keyword">or</span> -vv <span class="keyword">for</span> <span class="keyword">full</span> protocol <span class="keyword">decode</span>
listening <span class="keyword">on</span> wlan0, <span class="keyword">link</span>-<span class="keyword">type</span> EN10MB (Ethernet), capture <span class="keyword">size</span> <span class="number">65535</span> <span class="keyword">bytes</span>
<span class="number">14</span>:<span class="number">59</span>:<span class="number">49.589370</span> IP <span class="number">10.109</span><span class="number">.20</span><span class="number">.127</span> &gt; <span class="number">10.109</span><span class="number">.20</span><span class="number">.1</span>: ICMP address <span class="keyword">mask</span> request, <span class="keyword">length</span> <span class="number">12</span>
<span class="number">14</span>:<span class="number">59</span>:<span class="number">49.591828</span> IP <span class="number">10.109</span><span class="number">.20</span><span class="number">.1</span> &gt; <span class="number">10.109</span><span class="number">.20</span><span class="number">.127</span>: ICMP address <span class="keyword">mask</span> <span class="keyword">is</span> <span class="number">0xfffffc00</span>, <span class="keyword">length</span> <span class="number">12</span></span>
</code></pre><p>谁会响应我们的非echo ICMP请求？</p>
<ul>
<li>监听状态的机器。</li>
<li>实现这个标准的操作系统。</li>
<li>配置为支持这个ICMP请求。</li>
<li>没有被防火墙墙掉。</li>
</ul>
<p>大多数机器对折中非echo的ICMP请求是没响应的。</p>
<pre><code>~ ⮀ sudo nmap -<span class="literal">sP</span> -PM/E/P --disable-arp-ping <span class="number">10</span>.<span class="number">109</span>.<span class="number">23</span>.<span class="number">255</span>

<span class="label">Starting</span> Nmap <span class="number">6</span>.<span class="number">25</span> ( http://nmap.org ) at <span class="number">2014</span>-<span class="number">03</span>-<span class="number">15</span> <span class="number">15</span>:<span class="number">07</span> CST
<span class="label">Note</span>: Host seems down. <span class="preprocessor">If</span> <span class="keyword">it </span>is really up, <span class="keyword">but </span><span class="keyword">blocking </span>our ping probes, try -Pn
<span class="label">Nmap</span> done: <span class="number">1</span> <span class="literal">IP</span> <span class="keyword">address </span>(<span class="number">0</span> hosts up) scanned in <span class="number">2</span>.<span class="number">18</span> seconds
</code></pre><h2 id="ICMP_Parameter_Problem_Error_messages">ICMP Parameter Problem Error messages</h2><p>让目标机器生成ICMP参数错误消息的方法有：</p>
<ul>
<li>搞乱IP头：<ul>
<li>头长度域</li>
<li>IP报文option部分</li>
</ul>
</li>
<li>在IP头中使用无效的域值<ul>
<li>在IP头中使用有效的域值</li>
</ul>
</li>
<li>滥用分片</li>
<li>UDP扫描主机探测方法。</li>
</ul>
<p>IP中伪造而不会被无声丢弃的域：</p>
<ul>
<li>ihl</li>
<li>option</li>
<li>proto尝试不使用的</li>
</ul>
<p>我们先试试改头长度域的：</p>
<p>我们造个ihl有问题的包(<code>ihl</code>的值是32位即一个字的个数)：</p>
<pre><code> ~ ⮀ sudo scapy
<span class="constant">Welcome</span> to <span class="constant">Scapy</span> (<span class="number">2.2</span>.<span class="number">0</span>)
<span class="prompt">&gt;&gt;</span>&gt; ip = <span class="constant">IP</span>()/<span class="constant">ICMP</span>()
<span class="prompt">&gt;&gt;</span>&gt; ip.dst=<span class="string">'10.3.18.66'</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.ihl=<span class="number">6</span>L
<span class="prompt">&gt;&gt;</span>&gt; ip.show()
<span class="comment">###[ IP ]###</span>
  version= <span class="number">4</span>
  ihl= <span class="number">6</span>L
  tos= <span class="number">0x0</span>
  len= <span class="constant">None</span>
  id= <span class="number">1</span>
  flags= 
  frag= <span class="number">0</span>
  ttl= <span class="number">64</span>
  proto= icmp
  chksum= <span class="constant">None</span>
  src= <span class="number">10.210</span>.<span class="number">96.200</span>
  dst= <span class="number">10.3</span>.<span class="number">18.66</span>
  \options\
<span class="comment">###[ ICMP ]###</span>
     type= echo-request
     code= <span class="number">0</span>
     chksum= <span class="constant">None</span>
     id= <span class="number">0x0</span>
     seq= <span class="number">0x0</span>
<span class="prompt">&gt;&gt;</span>&gt; send(ip)
.
<span class="constant">Sent</span> <span class="number">1</span> packets.

<span class="symbol">tcpdump:</span> verbose output suppressed, use -v <span class="keyword">or</span> -vv <span class="keyword">for</span> full protocol decode
listening on eth<span class="number">0</span>, link-type <span class="constant">EN10MB</span> (<span class="constant">Ethernet</span>), capture size <span class="number">65535</span> bytes
<span class="number">14</span><span class="symbol">:</span><span class="number">45</span><span class="symbol">:</span><span class="number">29.035948</span> <span class="constant">IP</span> <span class="number">10.210</span>.<span class="number">96.200</span> &gt; <span class="number">10.3</span>.<span class="number">18.66</span><span class="symbol">:</span> [|icmp]
<span class="number">14</span><span class="symbol">:</span><span class="number">45</span><span class="symbol">:</span><span class="number">29.039536</span> <span class="constant">IP</span> <span class="number">10.210</span>.<span class="number">96.193</span> &gt; <span class="number">10.210</span>.<span class="number">96.200</span><span class="symbol">:</span> <span class="constant">ICMP</span> parameter problem - octet <span class="number">21</span>, length <span class="number">12</span>
</code></pre><p>为啥会参数错误，因为解析包的程序会把ICMP报文部分当成options处理。</p>
<p>同样，我们往options部分塞些奇奇怪怪的东西也可以完成同样效果。</p>
<pre><code> ~ ⮀ sudo scapy
<span class="constant">Welcome</span> to <span class="constant">Scapy</span> (<span class="number">2.2</span>.<span class="number">0</span>)
<span class="prompt">&gt;&gt;</span>&gt; ip = <span class="constant">IP</span>()/<span class="constant">ICMP</span>()
<span class="prompt">&gt;&gt;</span>&gt; ip.dst=<span class="string">'10.3.18.66'</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.show()
<span class="comment">###[ IP ]###</span>
  version= <span class="number">4</span>
  ihl= <span class="constant">None</span>
  tos= <span class="number">0x0</span>
  len= <span class="constant">None</span>
  id= <span class="number">1</span>
  flags= 
  frag= <span class="number">0</span>
  ttl= <span class="number">64</span>
  proto= icmp
  chksum= <span class="constant">None</span>
  src= <span class="number">10.210</span>.<span class="number">96.200</span>
  dst= <span class="number">10.3</span>.<span class="number">18.66</span>
  \options\
   |<span class="comment">###[ IPOption ]###</span>
   |  copy_flag= <span class="number">1</span>
   |  optclass= control
   |  option= extended_security
   |  length= <span class="constant">None</span>
   |  value= <span class="string">''</span>
<span class="comment">###[ ICMP ]###</span>
     type= echo-request
     code= <span class="number">0</span>
     chksum= <span class="constant">None</span>
     id= <span class="number">0x0</span>
     seq= <span class="number">0x0</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.options=<span class="constant">IPOption</span>(copy_flag=<span class="number">1</span>,optclass=<span class="number">0</span>,option=<span class="number">5</span>,value=<span class="string">''</span>)
<span class="prompt">&gt;&gt;</span>&gt; send(ip)
</code></pre><p>大快人心的是途中的路由返回的参数错误</p>
<pre><code> ~ ⮀ <span class="tag">sudo</span> <span class="tag">tcpdump</span> <span class="tag">-i</span> <span class="tag">eth0</span> "<span class="tag">icmp</span>"
 <span class="tag">tcpdump</span>: <span class="tag">verbose</span> <span class="tag">output</span> <span class="tag">suppressed</span>, <span class="tag">use</span> <span class="tag">-v</span> <span class="tag">or</span> <span class="tag">-vv</span> <span class="tag">for</span> <span class="tag">full</span> <span class="tag">protocol</span> <span class="tag">decode</span>
 <span class="tag">listening</span> <span class="tag">on</span> <span class="tag">eth0</span>, <span class="tag">link-type</span> <span class="tag">EN10MB</span> (<span class="tag">Ethernet</span>), <span class="tag">capture</span> <span class="tag">size</span> 65535 <span class="tag">bytes</span>
 15<span class="pseudo">:13</span><span class="pseudo">:30</span><span class="class">.787605</span> <span class="tag">IP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span> &gt; 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span>: <span class="tag">ICMP</span> <span class="tag">echo</span> <span class="tag">request</span>, <span class="tag">id</span> 0, <span class="tag">seq</span> 0, <span class="tag">length</span> 8
 15<span class="pseudo">:13</span><span class="pseudo">:30</span><span class="class">.790656</span> <span class="tag">IP</span> 10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> <span class="tag">parameter</span> <span class="tag">problem</span> <span class="tag">-</span> <span class="tag">octet</span> 20, <span class="tag">length</span> 40

 ~ ⮀ <span class="tag">traceroute</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> 
<span class="tag">traceroute</span> <span class="tag">to</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> (10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span>), 30 <span class="tag">hops</span> <span class="tag">max</span>, 60 <span class="tag">byte</span> <span class="tag">packets</span>
 1  10<span class="class">.210</span><span class="class">.96</span><span class="class">.193</span> (10<span class="class">.210</span><span class="class">.96</span><span class="class">.193</span>)  2<span class="class">.537</span> <span class="tag">ms</span>  2<span class="class">.798</span> <span class="tag">ms</span>  3<span class="class">.158</span> <span class="tag">ms</span>
 2  10<span class="class">.1</span><span class="class">.10</span><span class="class">.1</span> (10<span class="class">.2</span><span class="class">.100</span><span class="class">.1</span>)  1<span class="class">.260</span> <span class="tag">ms</span>  1<span class="class">.423</span> <span class="tag">ms</span>  1<span class="class">.425</span> <span class="tag">ms</span>
 3  10<span class="class">.1</span><span class="class">.2</span><span class="class">.1</span> (10<span class="class">.2</span><span class="class">.1</span><span class="class">.1</span>)  0<span class="class">.824</span> <span class="tag">ms</span>  1<span class="class">.197</span> <span class="tag">ms</span>  1<span class="class">.614</span> <span class="tag">ms</span>
 4  10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span> (10<span class="class">.0</span><span class="class">.10</span><span class="class">.1</span>)  0<span class="class">.504</span> <span class="tag">ms</span>  0<span class="class">.534</span> <span class="tag">ms</span>  0<span class="class">.542</span> <span class="tag">ms</span>
 5  10<span class="class">.0</span><span class="class">.13</span><span class="class">.2</span> (10<span class="class">.0</span><span class="class">.13</span><span class="class">.2</span>)  4<span class="class">.714</span> <span class="tag">ms</span>  4<span class="class">.895</span> <span class="tag">ms</span>  5<span class="class">.053</span> <span class="tag">ms</span>
 6  10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> (10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span>)  0<span class="class">.477</span> <span class="tag">ms</span>  0<span class="class">.428</span> <span class="tag">ms</span>  0<span class="class">.414</span> <span class="tag">ms</span>
</code></pre><p>在wireshark中可以看的更清楚：</p>
<pre><code>Extended Security (<span class="operator">with</span> option <span class="built_in">length</span> = <span class="number">2</span> <span class="keyword">bytes</span>; should be &gt;= <span class="number">3</span>)
</code></pre><p>我们发了一个奇怪的包= =</p>
<p><a href="http://althing.cs.dartmouth.edu/local/ICMP_Scanning_v3.0.pdf" target="_blank" rel="external">ICMP Usage in Scanning</a>中详述了使用这些技术探测ACL(访问控制列表)的神奇应用。</p>
<p>接着我们试试奇葩的protocol字段：</p>
<pre><code>&gt;&gt;&gt; ip.proto=<span class="number">155</span>
&gt;&gt;&gt; ip.show()
<span class="preprocessor">###[ IP ]###</span>
  version= <span class="number">4</span>
  ihl= None
  tos= <span class="number">0x0</span>
  len= None
  id= <span class="number">1</span>
  flags= 
  frag= <span class="number">0</span>
  ttl= <span class="number">64</span>
  proto= <span class="number">155</span>
  chksum= None
  src= <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span>
  dst= <span class="number">10.3</span><span class="number">.18</span><span class="number">.231</span>
  \options\
<span class="preprocessor">###[ UDP ]###</span>
     sport= domain
     dport= domain
     len= None
     chksum= None
&gt;&gt;&gt; send(ip)
.
Sent <span class="number">1</span> packets.
</code></pre><p>产生了一个destination unreachable(protocol unreachable)的错误报文。</p>
<pre><code> ~ ⮀ <span class="tag">sudo</span> <span class="tag">tcpdump</span> <span class="tag">-i</span> <span class="tag">eth0</span> "<span class="tag">icmp</span>"
<span class="tag">tcpdump</span>: <span class="tag">verbose</span> <span class="tag">output</span> <span class="tag">suppressed</span>, <span class="tag">use</span> <span class="tag">-v</span> <span class="tag">or</span> <span class="tag">-vv</span> <span class="tag">for</span> <span class="tag">full</span> <span class="tag">protocol</span> <span class="tag">decode</span>
<span class="tag">listening</span> <span class="tag">on</span> <span class="tag">eth0</span>, <span class="tag">link-type</span> <span class="tag">EN10MB</span> (<span class="tag">Ethernet</span>), <span class="tag">capture</span> <span class="tag">size</span> 65535 <span class="tag">bytes</span>
15<span class="pseudo">:43</span><span class="pseudo">:14</span><span class="class">.737608</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.231</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.231</span> <span class="tag">protocol</span> 155 <span class="tag">unreachable</span>, <span class="tag">length</span> 36
</code></pre><p>该技术可用于主机发现，用nmap也可以结合各种协议来进行ACL的探测。</p>
<pre><code>sudo nmap -sO <span class="number">10.3</span><span class="number">.18</span><span class="number">.66</span>
</code></pre><p>这是部分抓到的包：</p>
<pre><code> ~ ⮀ <span class="tag">sudo</span> <span class="tag">tcpdump</span> "<span class="tag">icmp</span>"
<span class="tag">tcpdump</span>: <span class="tag">verbose</span> <span class="tag">output</span> <span class="tag">suppressed</span>, <span class="tag">use</span> <span class="tag">-v</span> <span class="tag">or</span> <span class="tag">-vv</span> <span class="tag">for</span> <span class="tag">full</span> <span class="tag">protocol</span> <span class="tag">decode</span>
<span class="tag">listening</span> <span class="tag">on</span> <span class="tag">eth0</span>, <span class="tag">link-type</span> <span class="tag">EN10MB</span> (<span class="tag">Ethernet</span>), <span class="tag">capture</span> <span class="tag">size</span> 65535 <span class="tag">bytes</span>
15<span class="pseudo">:51</span><span class="pseudo">:15</span><span class="class">.618473</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 15 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:16</span><span class="class">.719654</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 241 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:17</span><span class="class">.820941</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 176 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:18</span><span class="class">.922155</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 126 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:19</span><span class="class">.427885</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 184 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:20</span><span class="class">.434376</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 45 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:21</span><span class="class">.455654</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 59 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:22</span><span class="class">.466907</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 37 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:23</span><span class="class">.478382</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 233 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:24</span><span class="class">.492506</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 162 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:25</span><span class="class">.531125</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 72 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:26</span><span class="class">.452325</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 255 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:27</span><span class="class">.473618</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 58 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:28</span><span class="class">.415352</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 25 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:29</span><span class="class">.435785</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 169 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:30</span><span class="class">.456992</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 206 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:31</span><span class="class">.478499</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.66</span> <span class="tag">protocol</span> 28 <span class="tag">unreachable</span>, <span class="tag">length</span> 28
15<span class="pseudo">:51</span><span class="pseudo">:31</span><span class="class">.527789</span> <span class="tag">IP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span> &gt; 10<span class="class">.3</span><span class="class">.9</span><span class="class">.4</span>: <span class="tag">ICMP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span> <span class="tag">udp</span> <span class="tag">port</span> 48089 <span class="tag">unreachable</span>, <span class="tag">length</span> 72
15<span class="pseudo">:51</span><span class="pseudo">:31</span><span class="class">.527806</span> <span class="tag">IP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span> &gt; 10<span class="class">.3</span><span class="class">.9</span><span class="class">.4</span>: <span class="tag">ICMP</span> 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span> <span class="tag">udp</span> <span class="tag">port</span> 55862 <span class="tag">unreachable</span>, <span class="tag">length</span> 72
</code></pre><h2 id="ICMP_Ip_Reassembly_Time_Exceeded">ICMP Ip Reassembly Time Exceeded</h2><p>我们可以故意把发送不完整的IP分片。来探测主机，当对一个网络实行这个伎俩时，就可以探测整个网络拓扑。</p>
<pre><code><span class="prompt">&gt;&gt;</span>&gt; ip = <span class="constant">IP</span>()/<span class="constant">TCP</span>()/<span class="string">"abcdefg"</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.flags=<span class="number">1</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.dst=<span class="string">'10.3.18.66'</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.show()
<span class="comment">###[ IP ]###</span>
  version= <span class="number">4</span>
  ihl= <span class="constant">None</span>
  tos= <span class="number">0x0</span>
  len= <span class="constant">None</span>
  id= <span class="number">1</span>
  flags= <span class="constant">MF</span>
  frag= <span class="number">0</span>
  ttl= <span class="number">64</span>
  proto= tcp
  chksum= <span class="constant">None</span>
  src= <span class="number">10.210</span>.<span class="number">96.200</span>
  dst= <span class="number">10.3</span>.<span class="number">18.66</span>
  \options\
<span class="comment">###[ TCP ]###</span>
     sport= ftp_data
     dport= http
     seq= <span class="number">0</span>
     ack= <span class="number">0</span>
     dataofs= <span class="constant">None</span>
     reserved= <span class="number">0</span>
     flags= <span class="constant">S</span>
     window= <span class="number">8192</span>
     chksum= <span class="constant">None</span>
     urgptr= <span class="number">0</span>
     options= {}
<span class="comment">###[ Raw ]###</span>
        load= <span class="string">'abcdefg'</span>
<span class="prompt">&gt;&gt;</span>&gt; send(ip)
.
<span class="constant">Sent</span> <span class="number">1</span> packets.
</code></pre><p>过了好久好久，返回一个重组分片超时IMCP错误</p>
<pre><code>~ ⮀ sudo tcpdump -i eth0 "icmp"
tcpdump: verbose output suppressed, <span class="operator"><span class="keyword">use</span> -v <span class="keyword">or</span> -vv <span class="keyword">for</span> <span class="keyword">full</span> protocol <span class="keyword">decode</span>
listening <span class="keyword">on</span> eth0, <span class="keyword">link</span>-<span class="keyword">type</span> EN10MB (Ethernet), capture <span class="keyword">size</span> <span class="number">65535</span> <span class="keyword">bytes</span>
<span class="number">16</span>:<span class="number">29</span>:<span class="number">22.186723</span> IP <span class="number">10.3</span><span class="number">.18</span><span class="number">.66</span> &gt; <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span>: ICMP ip reassembly <span class="keyword">time</span> exceeded, <span class="keyword">length</span> <span class="number">52</span></span>
</code></pre><p>不是所有主机都会对这个响应。我试了试局域网内有的设备就没反应= =。</p>
<p>但这个端口不需要打开，试试81端口(确认此台机器没有打开81端口)也是直接返回ICMP超时错误。操作系统会直接处理报文并返回错误消息。</p>
<p>我又试了试UDP：</p>
<p>不管你是不是扫描打开的端口，都返回同样的超时错误：</p>
<pre><code><span class="prompt">&gt;&gt;</span>&gt; ip[<span class="number">1</span>]=<span class="constant">UDP</span>()
<span class="prompt">&gt;&gt;</span>&gt; ip.show()
<span class="comment">###[ IP ]###</span>
  version= <span class="number">4</span>
  ihl= <span class="constant">None</span>
  tos= <span class="number">0x0</span>
  len= <span class="constant">None</span>
  id= <span class="number">1</span>
  flags= <span class="constant">MF</span>
  frag= <span class="number">0</span>
  ttl= <span class="number">64</span>
  proto= udp
  chksum= <span class="constant">None</span>
  src= <span class="number">10.210</span>.<span class="number">96.200</span>
  dst= <span class="number">10.210</span>.<span class="number">96.195</span>
  \options\
<span class="comment">###[ UDP ]###</span>
     sport= domain
     dport= domain
     len= <span class="constant">None</span>
     chksum= <span class="constant">None</span>
<span class="prompt">&gt;&gt;</span>&gt; ip[<span class="number">1</span>].dport=<span class="number">80</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.dst
<span class="string">'10.210.96.195'</span>
<span class="prompt">&gt;&gt;</span>&gt; ip.dst=<span class="string">'10.3.18.66'</span>
<span class="prompt">&gt;&gt;</span>&gt; send(ip)
.
<span class="constant">Sent</span> <span class="number">1</span> packets.
<span class="prompt">&gt;&gt;</span>&gt; ip[<span class="number">1</span>].dport=<span class="number">81</span>
<span class="prompt">&gt;&gt;</span>&gt; send(ip)
.
<span class="constant">Sent</span> <span class="number">1</span> packets.

 ~ ⮀ sudo tcpdump -i eth<span class="number">0</span> <span class="string">"host 10.3.18.66"</span>   
<span class="symbol">tcpdump:</span> verbose output suppressed, use -v <span class="keyword">or</span> -vv <span class="keyword">for</span> full protocol decode
listening on eth<span class="number">0</span>, link-type <span class="constant">EN10MB</span> (<span class="constant">Ethernet</span>), capture size <span class="number">65535</span> bytes
<span class="number">16</span><span class="symbol">:</span><span class="number">46</span><span class="symbol">:</span><span class="number">46.455970</span> <span class="constant">IP</span> <span class="number">10.210</span>.<span class="number">96.200</span>.domain &gt; <span class="number">10.3</span>.<span class="number">18.66</span>.<span class="symbol">http:</span> [|domain]
<span class="number">16</span><span class="symbol">:</span><span class="number">47</span><span class="symbol">:</span><span class="number">16.455677</span> <span class="constant">IP</span> <span class="number">10.3</span>.<span class="number">18.66</span> &gt; <span class="number">10.210</span>.<span class="number">96.200</span><span class="symbol">:</span> <span class="constant">ICMP</span> ip reassembly time exceeded, length <span class="number">36</span>
<span class="number">16</span><span class="symbol">:</span><span class="number">47</span><span class="symbol">:</span><span class="number">29.237026</span> <span class="constant">IP</span> <span class="number">10.210</span>.<span class="number">96.200</span>.domain &gt; <span class="number">10.3</span>.<span class="number">18.66</span>.hosts2-<span class="symbol">ns:</span> [|domain]
<span class="number">16</span><span class="symbol">:</span><span class="number">47</span><span class="symbol">:</span><span class="number">59.236648</span> <span class="constant">IP</span> <span class="number">10.3</span>.<span class="number">18.66</span> &gt; <span class="number">10.210</span>.<span class="number">96.200</span><span class="symbol">:</span> <span class="constant">ICMP</span> ip reassembly time exceeded, length <span class="number">36</span>
</code></pre><p>这和前文提到的<a href="http://althing.cs.dartmouth.edu/local/ICMP_Scanning_v3.0.pdf" target="_blank" rel="external">ICMP Usage in Scanning</a>所说的不一样！！！！！</p>
<p>我懒得再试其它机器和封装个ICMP包的例子了。</p>
<p>好吧，还是试了试，一个没反应。一个对开放端口(22)和非开放端口(23)都返回同样值。</p>
<pre><code>&gt;&gt;&gt; ip.dst=<span class="string">'10.210.96.210'</span>
&gt;&gt;&gt; <span class="function"><span class="title">send</span><span class="params">(ip)</span></span>
.
Sent <span class="number">1</span> packets.
&gt;&gt;&gt; ip.dst=<span class="string">'10.210.96.195'</span>
&gt;&gt;&gt; ip[<span class="number">1</span>].dport=<span class="number">22</span>
&gt;&gt;&gt; <span class="function"><span class="title">send</span><span class="params">(ip)</span></span>
.
Sent <span class="number">1</span> packets.
&gt;&gt;&gt; ip[<span class="number">1</span>].dport=<span class="number">23</span>
&gt;&gt;&gt; <span class="function"><span class="title">send</span><span class="params">(ip)</span></span>
.
Sent <span class="number">1</span> packets.

<span class="number">16</span>:<span class="number">58</span>:<span class="number">25.736005</span> IP <span class="number">10.210</span>.<span class="number">96.200</span><span class="class">.ftp-data</span> &gt; <span class="number">10.210</span>.<span class="number">96.195</span><span class="class">.ssh</span>: Flags [S], seq <span class="number">0</span>, win <span class="number">8192</span>, length <span class="number">0</span>
<span class="number">16</span>:<span class="number">58</span>:<span class="number">55.765861</span> IP <span class="number">10.210</span>.<span class="number">96.195</span> &gt; <span class="number">10.210</span>.<span class="number">96.200</span>: ICMP ip reassembly <span class="tag">time</span> exceeded, length <span class="number">44</span>
<span class="number">16</span>:<span class="number">59</span>:<span class="number">15.097094</span> IP <span class="number">10.210</span>.<span class="number">96.200</span><span class="class">.ftp-data</span> &gt; <span class="number">10.210</span>.<span class="number">96.195</span><span class="class">.telnet</span>: Flags [S], seq <span class="number">0</span>, win <span class="number">8192</span>, length <span class="number">0</span>
<span class="number">16</span>:<span class="number">59</span>:<span class="number">45.171689</span> IP <span class="number">10.210</span>.<span class="number">96.195</span> &gt; <span class="number">10.210</span>.<span class="number">96.200</span>: ICMP ip reassembly <span class="tag">time</span> exceeded, length <span class="number">44</span>
</code></pre><p>和文档描述的不相同，但只要有ICMP报文返回，说明主机是打开的。(好像没什么用…)</p>
<h2 id="UDP扫描">UDP扫描</h2><p>结合各种协议和端口，探测内网拓扑。</p>
<p>比如，我们可以先用nmap ping 扫射下某网段，然后分别试着尝试协议端口。</p>
<pre><code><span class="prompt">&gt;&gt;&gt; </span>ip[<span class="number">1</span>]=UDP()
<span class="prompt">&gt;&gt;&gt; </span>ip.show()
<span class="comment">###[ IP ]###</span>
  version= <span class="number">4</span>
  ihl= <span class="keyword">None</span>
  tos= <span class="number">0x0</span>
  len= <span class="keyword">None</span>
  id= <span class="number">1</span>
  flags= 
  frag= <span class="number">0</span>
  ttl= <span class="number">64</span>
  proto= udp
  chksum= <span class="keyword">None</span>
  src= <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span>
  dst= <span class="number">10.3</span><span class="number">.18</span><span class="number">.66</span>
  \options\
<span class="comment">###[ UDP ]###</span>
     sport= domain
     dport= domain
     len= <span class="keyword">None</span>
     chksum= <span class="keyword">None</span>
<span class="prompt">&gt;&gt;&gt; </span>send(ip)
.
Sent <span class="number">1</span> packets.

 ~ ⮀ sudo nmap -sP <span class="number">10.3</span><span class="number">.18</span><span class="number">.66</span>/<span class="number">24</span> 
Nmap scan report <span class="keyword">for</span> <span class="number">10.3</span><span class="number">.18</span><span class="number">.213</span>
Host <span class="keyword">is</span> up (<span class="number">0.00052</span>s latency).
Nmap scan report <span class="keyword">for</span> <span class="number">10.3</span><span class="number">.18</span><span class="number">.231</span>
Host <span class="keyword">is</span> up (<span class="number">0.00052</span>s latency).
Nmap scan report <span class="keyword">for</span> <span class="number">10.3</span><span class="number">.18</span><span class="number">.232</span>
Host <span class="keyword">is</span> up (<span class="number">0.00038</span>s latency).

<span class="prompt">&gt;&gt;&gt; </span>ip.dst=<span class="string">'10.3.18.230'</span>
<span class="prompt">&gt;&gt;&gt; </span>send(ip)
.
Sent <span class="number">1</span> packets.
<span class="prompt">&gt;&gt;&gt; </span>ip.dst=<span class="string">'10.3.18.231'</span>
<span class="prompt">&gt;&gt;&gt; </span>send(ip)
.
Sent <span class="number">1</span> packets.
</code></pre><p>只有<code>10.3.18.231</code>这个活着的机器有返回destination unreachable(Port unreachable)报文。</p>
<pre><code> ~ ⮀ <span class="tag">sudo</span> <span class="tag">tcpdump</span> <span class="tag">-i</span> <span class="tag">eth0</span> "<span class="tag">icmp</span>"
<span class="tag">tcpdump</span>: <span class="tag">verbose</span> <span class="tag">output</span> <span class="tag">suppressed</span>, <span class="tag">use</span> <span class="tag">-v</span> <span class="tag">or</span> <span class="tag">-vv</span> <span class="tag">for</span> <span class="tag">full</span> <span class="tag">protocol</span> <span class="tag">decode</span>
<span class="tag">listening</span> <span class="tag">on</span> <span class="tag">eth0</span>, <span class="tag">link-type</span> <span class="tag">EN10MB</span> (<span class="tag">Ethernet</span>), <span class="tag">capture</span> <span class="tag">size</span> 65535 <span class="tag">bytes</span>
15<span class="pseudo">:39</span><span class="pseudo">:12</span><span class="class">.697553</span> <span class="tag">IP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.231</span> &gt; 10<span class="class">.210</span><span class="class">.96</span><span class="class">.200</span>: <span class="tag">ICMP</span> 10<span class="class">.3</span><span class="class">.18</span><span class="class">.231</span> <span class="tag">udp</span> <span class="tag">port</span> <span class="tag">domain</span> <span class="tag">unreachable</span>, <span class="tag">length</span> 36
</code></pre><h2 id="分片与MTU">分片与MTU</h2><p>我的意思是，恰巧目标网络的MTU比上一跳网络的MTU小，如果我们设置DF标志为1,同时让IP数据包的值介于两者之间，然后倒霉的内网路由器就会发回Fragmentation Needed ICMP报文。</p>
<p>该死的我没找到比我更小的MTU网段了。现在无线网没人用了？</p>
<h2 id="Inverse_Mapping">Inverse Mapping</h2><p>大多数防火墙不过滤ICMP reply。</p>
<p>假设我们的ip是<code>10.210.96.200</code>，<code>10.210.97.195</code>是存在的。而<code>10.210.97.196</code>不在线。</p>
<pre><code><span class="prompt">&gt;&gt;</span>&gt; icmp = <span class="constant">IP</span>()/<span class="constant">ICMP</span>()
<span class="prompt">&gt;&gt;</span>&gt; icmp.dst=<span class="string">'10.210.97.195'</span>
<span class="prompt">&gt;&gt;</span>&gt; icmp.show()
<span class="comment">###[ IP ]###</span>
  version= <span class="number">4</span>
  ihl= <span class="constant">None</span>
  tos= <span class="number">0x0</span>
  len= <span class="constant">None</span>
  id= <span class="number">1</span>
  flags= 
  frag= <span class="number">0</span>
  ttl= <span class="number">64</span>
  proto= icmp
  chksum= <span class="constant">None</span>
  src= <span class="number">10.210</span>.<span class="number">96.200</span>
  dst= <span class="number">10.210</span>.<span class="number">97.195</span>
  \options\
<span class="comment">###[ ICMP ]###</span>
     type= echo-reply
     code= <span class="number">0</span>
     chksum= <span class="constant">None</span>
     id= <span class="number">0x0</span>
     seq= <span class="number">0x0</span>
<span class="prompt">&gt;&gt;</span>&gt; send(icmp)
.
<span class="constant">Sent</span> <span class="number">1</span> packets.

 ~ ⮀ sudo tcpdump -i eth<span class="number">0</span> <span class="string">"host 10.210.97.195"</span>
<span class="symbol">tcpdump:</span> verbose output suppressed, use -v <span class="keyword">or</span> -vv <span class="keyword">for</span> full protocol decode
listening on eth<span class="number">0</span>, link-type <span class="constant">EN10MB</span> (<span class="constant">Ethernet</span>), capture size <span class="number">65535</span> bytes
<span class="number">22</span><span class="symbol">:</span><span class="number">51</span><span class="symbol">:</span><span class="number">47.187719</span> <span class="constant">IP</span> <span class="number">10.210</span>.<span class="number">96.200</span> &gt; <span class="number">10.210</span>.<span class="number">97.195</span><span class="symbol">:</span> <span class="constant">ICMP</span> echo reply, id <span class="number">0</span>, seq <span class="number">0</span>, length <span class="number">8</span>
<span class="number">22</span><span class="symbol">:</span><span class="number">51</span><span class="symbol">:</span><span class="number">47.188369</span> <span class="constant">IP</span> <span class="number">10.210</span>.<span class="number">97.195</span> &gt; <span class="number">10.210</span>.<span class="number">96.200</span><span class="symbol">:</span> <span class="constant">ICMP</span> <span class="number">10.210</span>.<span class="number">97.195</span> protocol <span class="number">1</span> unreachable, length <span class="number">36</span>
</code></pre><p>发现<code>10.210.97.195</code>竟然尼码响应了！！！！！！协议不可到达！！</p>
<p>不存在的ip地址则没有响应！这尼码完全和上文提到的<a href="http://althing.cs.dartmouth.edu/local/ICMP_Scanning_v3.0.pdf" target="_blank" rel="external">ICMP Usage in Scanning</a>说的相反好么！！！</p>
<pre><code><span class="prompt">&gt;&gt;</span>&gt; icmp.dst=<span class="string">'10.210.97.196'</span>
<span class="prompt">&gt;&gt;</span>&gt; send(icmp)
.
<span class="constant">Sent</span> <span class="number">1</span> packets.

~ ⮀ sudo tcpdump -i eth<span class="number">0</span> <span class="string">"host 10.210.97.196"</span>
<span class="symbol">tcpdump:</span> verbose output suppressed, use -v <span class="keyword">or</span> -vv <span class="keyword">for</span> full protocol decode
listening on eth<span class="number">0</span>, link-type <span class="constant">EN10MB</span> (<span class="constant">Ethernet</span>), capture size <span class="number">65535</span> bytes
<span class="number">22</span><span class="symbol">:</span><span class="number">56</span><span class="symbol">:</span><span class="number">15.725836</span> <span class="constant">IP</span> <span class="number">10.210</span>.<span class="number">96.200</span> &gt; <span class="number">10.210</span>.<span class="number">97.196</span><span class="symbol">:</span> <span class="constant">ICMP</span> echo reply, id <span class="number">0</span>, seq <span class="number">0</span>, length <span class="number">8</span>
</code></pre><p>不过后来找到个在线的<code>10.210.97.200</code>也不响应。</p>
<pre><code>&gt;&gt;&gt; icmp.dst=<span class="string">'10.210.97.200'</span>
&gt;&gt;&gt; <span class="built_in">send</span>(icmp)
.
Sent <span class="number">1</span> packets.

 ~ ⮀ sudo tcpdump -i eth0 <span class="string">"host 10.210.97.200"</span>
tcpdump: verbose output suppressed, use -v <span class="operator">or</span> -vv <span class="keyword">for</span> full protocol decode
listening <span class="command"><span class="keyword">on</span> <span class="title">eth0</span>, <span class="title">link-type</span> <span class="title">EN10MB</span> (<span class="title">Ethernet</span>), <span class="title">capture</span> <span class="title">size</span> <span class="title">65535</span> <span class="title">bytes</span></span>
<span class="number">22</span>:<span class="number">59</span>:<span class="number">10.235963</span> IP <span class="number">10.210</span><span class="number">.96</span><span class="number">.200</span> &gt; <span class="number">10.210</span><span class="number">.97</span><span class="number">.200</span>: ICMP echo reply, id <span class="number">0</span>, seq <span class="number">0</span>, <span class="built_in">length</span> <span class="number">8</span>

 ~ ⮀ ping <span class="number">10.210</span><span class="number">.97</span><span class="number">.200</span>
PING <span class="number">10.210</span><span class="number">.97</span><span class="number">.200</span> (<span class="number">10.210</span><span class="number">.97</span><span class="number">.200</span>) <span class="number">56</span>(<span class="number">84</span>) <span class="keyword">bytes</span> <span class="operator">of</span> data.
<span class="number">64</span> <span class="keyword">bytes</span> <span class="built_in">from</span> <span class="number">10.210</span><span class="number">.97</span><span class="number">.200</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">63</span> <span class="built_in">time</span>=<span class="number">0.520</span> ms
<span class="number">64</span> <span class="keyword">bytes</span> <span class="built_in">from</span> <span class="number">10.210</span><span class="number">.97</span><span class="number">.200</span>: icmp_seq=<span class="number">2</span> ttl=<span class="number">63</span> <span class="built_in">time</span>=<span class="number">0.559</span> ms
</code></pre><p>丧心病狂，说明路由存在ip就转发了，不存在就默默丢弃了。至于<code>10.210.97.195</code>是什么毛病会给我个协议不可达(它可能是个路由器)……<code>Who can tell me...</code></p>
<h2 id="ICMP与操作系统探测">ICMP与操作系统探测</h2><p><a href="http://althing.cs.dartmouth.edu/local/ICMP_Scanning_v3.0.pdf" target="_blank" rel="external">ICMP Usage in Scanning</a>的作者也是xprobe的作者，我不打算继续玩ICMP这项深坑了：</p>
<pre><code><span class="preprocessor"># eix xprobe</span>
* net-analyzer/xprobe
     Available versions:  ~<span class="number">0.3</span>
     Homepage:            http:<span class="comment">//sys-security.com/blog/xprobe2</span>
     Description:         Active OS fingerprinting tool - <span class="keyword">this</span> is Xprobe2
</code></pre><h2 id="ICMP_source_quench">ICMP source quench</h2><p>应该被废弃的(2012年的RFC6633)协议，流量控制应该交给TCP来做。如果要伪造需要猜测TCP序号，端口号等(前八字节)。</p>
<p>我试着发了发包……看样子路由比我的网卡强大太多了。</p>
<h2 id="ICMP_重定向">ICMP 重定向</h2><p>扔一个参考资料，用hping的<a href="http://www.bcitr.com/files/icmp-redir.pdf" target="_blank" rel="external">How To – Poison Route Cache Using ICMP Redirect</a></p>
<p>待我哪天土豪了再说吧……最起码现在我的安卓功能受限，总之我没模拟出来啥效果。反正我在一个网段试了试完全没动静。其实我觉得应该现在操作系统都会检查ICMP报文中的IP报头和IP报文数据前八字节吧。那又得猜TCP端口号和序列号了不是？</p>
<p>FIXME:<a href="http://en.wikipedia.org/wiki/ICMP_tunnel" target="_blank" rel="external">ICMP Tunnel</a>，有空试试。</p>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/network/" rel="tag">#network</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/network/2014/03/07/play-dhcp/" rel="next" title="Playing and Learning DHCP in Action">
                <i class="fa fa-chevron-left"></i> Playing and Learning DHCP in Action
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/network/2014/04/03/gns3-on-gentoo-linux/" rel="prev" title="GNS3 on Gentoo Linux">
                GNS3 on Gentoo Linux <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


        </div>

        


        
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </div>
    
  </div>


      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Liu Yuyang" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Liu Yuyang</p>
        </div>
        <p class="site-description motion-element" itemprop="description">我希望生活是诗的，是画的，是无数动听的音符。我希望我是自由的，摇滚的，有一颗黑客的心。</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">175</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">61</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/reverland" target="_blank">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
                <a href="http://reverland.bitbucket.org/" target="_blank">曾经的的vimwiki</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://liutos.github.com/" target="_blank">Liutos</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.phoenixlzx.com/" target="_blank">凤凰君</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://gndrive.org/" target="_blank">高达数字实验室</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cherrot.com/" target="_blank">Cherrot</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://xwyam.github.com/" target="_blank">xw_y_am</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://ishell.me" target="_blank">小东</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.kochiya.me/" target="_blank">AS酱</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.skydark.info/" target="_blank">skydark</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://thorb.cn/" target="_blank">thorb</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.suzibin.cn/" target="_blank">doug</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://armsword.com/" target="_blank">armsword</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://zhangwenli.com/blog" target="_blank">Ovilia</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://lilydjwg.is-programmer.com/" target="_blank">仙子</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://gaohaoyang.github.io" target="_blank">HYG</a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://simmer-jun.github.io" target="_blank">Simmer</a>
              </span>
            
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ping和traceroute"><span class="nav-number">1.</span> <span class="nav-text">ping和traceroute</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ping扫射和广播ICMP"><span class="nav-number">2.</span> <span class="nav-text">ping扫射和广播ICMP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP_Timestamp_query"><span class="nav-number">3.</span> <span class="nav-text">ICMP Timestamp query</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP_address_netmask_request"><span class="nav-number">4.</span> <span class="nav-text">ICMP address netmask request</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP_Parameter_Problem_Error_messages"><span class="nav-number">5.</span> <span class="nav-text">ICMP Parameter Problem Error messages</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP_Ip_Reassembly_Time_Exceeded"><span class="nav-number">6.</span> <span class="nav-text">ICMP Ip Reassembly Time Exceeded</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UDP扫描"><span class="nav-number">7.</span> <span class="nav-text">UDP扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分片与MTU"><span class="nav-number">8.</span> <span class="nav-text">分片与MTU</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Inverse_Mapping"><span class="nav-number">9.</span> <span class="nav-text">Inverse Mapping</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP与操作系统探测"><span class="nav-number">10.</span> <span class="nav-text">ICMP与操作系统探测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP_source_quench"><span class="nav-number">11.</span> <span class="nav-text">ICMP source quench</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ICMP_重定向"><span class="nav-number">12.</span> <span class="nav-text">ICMP 重定向</span></a></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2011 - 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liu Yuyang</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  

    <script type="text/javascript">
      var disqus_shortname = 'reverlandblog';
      var disqus_identifier = 'network/2014/03/15/play-icmp/';
      var disqus_title = 'Playing and Learning ICMP in Action';
      var disqus_url = 'http://reverland.org/network/2014/03/15/play-icmp/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.2" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    motionMiddleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');
      if (CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          displaySidebar();
        }
      }
    };
  });
</script>



  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/MathJax.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/config/TeX-AMS-MML_HTMLorMML.js"></script>
  


  
  

</body>
</html>
