<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
    <link href='//fonts.lug.ustc.edu.cn/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="linux," />








  <link rel="shortcut icon" type="image/x-icon" href="http://wx.qlogo.cn/mmopen/xiaR0Twic472lOTwH1OBL4JeeIT174LxwcYvg3QBJYrV00Yfacmae1QTrhuQsjszkR4NhHbYWEtIE2ITRzVhVBRI4HuSpQBEwR/0?v=0.4.5.2" />






<meta name="description" content="警告：渣行文，就是想到什么扯什么……散漫不羁，漫无主题。
注：你也许可以把这篇极水的流水帐当作 Tentative Instruction for gentoo on Samsung R429 不过我写这篇文章的目的在于自我警戒与警戒他人，一次gentoo安装让本屌丝sb本质暴露无疑，诸位看官引以为戒。
机器信息Cpu信息,这就是传说中的i3 XD
⚡ root@gentoo ⮀ ~ ⮀ lscp">
<meta property="og:type" content="article">
<meta property="og:title" content="Hello, Gentoo">
<meta property="og:url" content="http://reverland.org/linux/2013/01/13/moving-to-gentoo/index.html">
<meta property="og:site_name" content="Reverland的行知阁">
<meta property="og:description" content="警告：渣行文，就是想到什么扯什么……散漫不羁，漫无主题。
注：你也许可以把这篇极水的流水帐当作 Tentative Instruction for gentoo on Samsung R429 不过我写这篇文章的目的在于自我警戒与警戒他人，一次gentoo安装让本屌丝sb本质暴露无疑，诸位看官引以为戒。
机器信息Cpu信息,这就是传说中的i3 XD
⚡ root@gentoo ⮀ ~ ⮀ lscp">
<meta property="og:image" content="http://fmn.rrimg.com/fmn061/20130118/2335/original_YQIC_17da0000045a1191.jpg">
<meta property="og:image" content="http://fmn.xnpic.com/fmn057/20130118/2340/original_KSFt_2596000000361191.jpg">
<meta property="og:image" content="http://fmn.rrimg.com/fmn060/20130118/2340/original_hO3c_3601000002281190.jpg">
<meta property="og:updated_time" content="2015-11-12T16:34:08.684Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hello, Gentoo">
<meta name="twitter:description" content="警告：渣行文，就是想到什么扯什么……散漫不羁，漫无主题。
注：你也许可以把这篇极水的流水帐当作 Tentative Instruction for gentoo on Samsung R429 不过我写这篇文章的目的在于自我警戒与警戒他人，一次gentoo安装让本屌丝sb本质暴露无疑，诸位看官引以为戒。
机器信息Cpu信息,这就是传说中的i3 XD
⚡ root@gentoo ⮀ ~ ⮀ lscp">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post',
    motion: true
  };
</script>

  <title> Hello, Gentoo | Reverland的行知阁 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  






  <div class="container one-column page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Reverland的行知阁</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">开放、分享、自由与进步</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Hello, Gentoo
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2013-01-13T00:00:00+08:00" content="2013-01-13">
              2013-01-13
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/linux/" itemprop="url" rel="index">
                    <span itemprop="name">linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        <span itemprop="articleBody"><p>警告：<em>渣行文</em>，就是想到什么扯什么……散漫不羁，漫无主题。</p>
<p>注：你也许可以把这篇极水的流水帐当作 <em>Tentative Instruction for gentoo on Samsung R429</em> 不过我写这篇文章的目的在于自我警戒与警戒他人，一次gentoo安装让本屌丝sb本质暴露无疑，诸位看官引以为戒。</p>
<h1 id="机器信息">机器信息</h1><p>Cpu信息,这就是传说中的<em>i3</em> XD</p>
<pre><code>⚡ root@gentoo ⮀ ~ ⮀ lscpu 
Architecture:          x86_64
CPU <span class="function"><span class="title">op-mode</span><span class="params">(s)</span></span>:        <span class="number">32</span>-bit, <span class="number">64</span>-bit
Byte Order:            Little Endian
<span class="function"><span class="title">CPU</span><span class="params">(s)</span></span>:                <span class="number">4</span>
On-line <span class="function"><span class="title">CPU</span><span class="params">(s)</span></span> list:   <span class="number">0</span>-<span class="number">3</span>
<span class="function"><span class="title">Thread</span><span class="params">(s)</span></span> per core:    <span class="number">2</span>
<span class="function"><span class="title">Core</span><span class="params">(s)</span></span> per socket:    <span class="number">2</span>
<span class="function"><span class="title">Socket</span><span class="params">(s)</span></span>:             <span class="number">1</span>
Vendor ID:             GenuineIntel
CPU family:            <span class="number">6</span>
Model:                 <span class="number">37</span>
Stepping:              <span class="number">2</span>
CPU MHz:               <span class="number">2266.000</span>
BogoMIPS:              <span class="number">4521.96</span>
Virtualization:        VT-x
L1d cache:             <span class="number">32</span>K
L1i cache:             <span class="number">32</span>K
L2 cache:              <span class="number">256</span>K
L3 cache:              <span class="number">3072</span>K
</code></pre><p>硬件：</p>
<pre><code>⚡ root<span class="comment">@gentoo ⮀ ~ ⮀ lspci</span>
<span class="number">00</span>:<span class="number">00</span>.<span class="number">0</span> Host <span class="keyword">bridge: </span>Intel Corporation Core Processor DRAM Controller (<span class="keyword">rev </span><span class="number">12</span>)
<span class="number">00</span>:<span class="number">01</span>.<span class="number">0</span> PCI <span class="keyword">bridge: </span>Intel Corporation Core Processor PCI Express x16 Root Port (<span class="keyword">rev </span><span class="number">12</span>)
<span class="number">00</span>:<span class="number">1</span>a.<span class="number">0</span> USB controller: Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset USB2 Enhanced Host Controller (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>b.<span class="number">0</span> Audio device: Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset High Definition Audio (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>c.<span class="number">0</span> PCI <span class="keyword">bridge: </span>Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset PCI Express Root Port <span class="number">1</span> (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>c.<span class="number">2</span> PCI <span class="keyword">bridge: </span>Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset PCI Express Root Port <span class="number">3</span> (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>c.<span class="number">3</span> PCI <span class="keyword">bridge: </span>Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset PCI Express Root Port <span class="number">4</span> (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>d.<span class="number">0</span> USB controller: Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset USB2 Enhanced Host Controller (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>e.<span class="number">0</span> PCI <span class="keyword">bridge: </span>Intel Corporation <span class="number">82801</span> Mobile PCI <span class="keyword">Bridge </span>(<span class="keyword">rev </span>a6)
<span class="number">00</span>:<span class="number">1</span>f.<span class="number">0</span> ISA <span class="keyword">bridge: </span>Intel Corporation Mobile <span class="number">5</span> Series Chipset LPC Interface Controller (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>f.<span class="number">2</span> SATA controller: Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset <span class="number">4</span> port SATA AHCI Controller (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">00</span>:<span class="number">1</span>f.<span class="number">3</span> SMBus: Intel Corporation <span class="number">5</span> Series/<span class="number">3400</span> Series Chipset SMBus Controller (<span class="keyword">rev </span><span class="number">06</span>)
<span class="number">02</span>:<span class="number">00</span>.<span class="number">0</span> VGA compatible controller: NVIDIA Corporation GT218 [GeForce <span class="number">310</span>M] (<span class="keyword">rev </span><span class="literal">a2</span>)
<span class="number">02</span>:<span class="number">00</span>.<span class="number">1</span> Audio device: NVIDIA Corporation High Definition Audio Controller (<span class="keyword">rev </span><span class="literal">a1</span>)
<span class="number">03</span>:<span class="number">00</span>.<span class="number">0</span> Network controller: Atheros Communications Inc. AR9285 Wireless Network Adapter (PCI-Express) (<span class="keyword">rev </span><span class="number">01</span>)
<span class="number">07</span>:<span class="number">00</span>.<span class="number">0</span> Ethernet controller: <span class="keyword">Marvell </span>Technology Group Ltd. Yukon Optima <span class="number">88</span>E8059 [PCIe Gigabit Ethernet Controller with AVB] (<span class="keyword">rev </span><span class="number">11</span>)
<span class="number">3</span>f:<span class="number">00</span>.<span class="number">0</span> Host <span class="keyword">bridge: </span>Intel Corporation Core Processor QuickPath Architecture Generic Non-core Registers (<span class="keyword">rev </span><span class="number">02</span>)
<span class="number">3</span>f:<span class="number">00</span>.<span class="number">1</span> Host <span class="keyword">bridge: </span>Intel Corporation Core Processor QuickPath Architecture System <span class="keyword">Address </span>Decoder (<span class="keyword">rev </span><span class="number">02</span>)
<span class="number">3</span>f:<span class="number">02</span>.<span class="number">0</span> Host <span class="keyword">bridge: </span>Intel Corporation Core Processor QPI Link <span class="number">0</span> (<span class="keyword">rev </span><span class="number">02</span>)
<span class="number">3</span>f:<span class="number">02</span>.<span class="number">1</span> Host <span class="keyword">bridge: </span>Intel Corporation Core Processor QPI Physical <span class="number">0</span> (<span class="keyword">rev </span><span class="number">02</span>)
<span class="number">3</span>f:<span class="number">02</span>.<span class="number">2</span> Host <span class="keyword">bridge: </span>Intel Corporation Core Processor Reserved (<span class="keyword">rev </span><span class="number">02</span>)
<span class="number">3</span>f:<span class="number">02</span>.<span class="number">3</span> Host <span class="keyword">bridge: </span>Intel Corporation Core Processor Reserved (<span class="keyword">rev </span><span class="number">02</span>)
</code></pre><h2 id=":s/arch/gentoo/gc">:s/arch/gentoo/gc</h2><p>2013年一月十三日，开始装gentoo。依照<a href="http://www.gentoo.org/doc/en/altinstall.xml" target="_blank" rel="external">The Gentoo Linux alternative installation method HOWTO</a>从BT5 R3的liveusb来chroot过去部署的stage3。一年多linux使用的结果是，chroot轻车熟路，archwiki中chroot那章还是我翻译的呢，不过……渣翻译。</p>
<p>没什么理由，甚至对arch相当满意。然后就顺手给<code>/</code>和<code>/boot</code>干掉了……单独分区天然优势，不用折腾什么lvm就能大胆的乱搞……</p>
<pre><code>Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *          <span class="number">63</span>      <span class="number">208844</span>      <span class="number">104391</span>   <span class="number">83</span>  Linux
/dev/sda2          <span class="number">208845</span>     <span class="number">4417874</span>     <span class="number">2104515</span>   <span class="number">82</span>  Linux swap / Solaris
/dev/sda3         <span class="number">4417875</span>    <span class="number">65866499</span>    <span class="number">30724312</span>+  <span class="number">83</span>  Linux
/dev/sda4        <span class="number">65866500</span>   <span class="number">625137344</span>   <span class="number">279635422</span>+  <span class="number">83</span>  Linux
</code></pre><h2 id="引导">引导</h2><p>这是这次安装和配置gentoo时犯的第一次sb……</p>
<p>当时内核编译好。手册上的示例是grub和lilo做引导，而我习惯syslinux。素来以尊重用户选择为指引的gentoo在手册上就是没提及半点syslinux，而在arch下的操作又不一样。于是找到gentoo的syslinux的wiki。按wiki步骤写了自己的<code>extlinux.conf</code>:</p>
<pre><code>TIMEOUT 30
ONTIMEOUT gentoo

UI vesamenu.c32
MENU TITLE <span class="keyword">Boot</span>

<span class="keyword">LABEL</span> gentoo
MENU <span class="keyword">LABEL</span> Gentoo Linux
KERNEL /<span class="keyword">boot</span>/kernel-genkernel-x86_64-3.6.11-gentoo
<span class="keyword">APPEND</span> initrd=/<span class="keyword">boot</span>/initramfs-genkernel-x86_64-3.6.11-gentoo root=/dev/sda3 acpi_osi=Linux acpi_backlight=vendor
</code></pre><p>然后重启……无法载入root，进入某个rescue shell内，什么神shell什么命令都没用。</p>
<p>冷关机chroot，查找资料改以上配置文件n次，重装extlinux又n次，重启n次，依然无解。然后忽然发现……extlinux的配置文件是<code>extlinux.conf</code>,而不像syslinux，pxelinux和isolinux那样都是<code>.cfg</code>，瞬间知道自己sb了……</p>
<h2 id="图形界面">图形界面</h2><p>然后还算顺利吧，开源驱动编译了好久，emerge不会用，我是什么都：</p>
<pre><code>emerge <span class="comment">--autounmask-write foo</span>
<span class="built_in">dispatch</span>-conf
u
emerge foo
</code></pre><p>奇葩的是我想到什么emerge什么……于是搞了好久都没有图形界面用……</p>
<p>搞了个xterm+luit+telnet上听雨……发现字体显示不全……和听雨技术blabla的用英语开始版聊，然后十大了……囧</p>
<p>为了能一边上网水贴吧，一边编译系统。第二天回到BT5的liveusb环境中去了，又把自己喜欢的东西先emerge出来了……图形界面还没起来把gimp和vlc就编译好了……</p>
<p>等开源驱动装好，kdebase-startkde装好之后，重liveusb环境重启，擦……奇葩的分辨率……然后又开始查怎么调分辨率。</p>
<p>然后从开源到闭源，发现闭源不能调亮度，再加上没有kms很不爽，又转到开源。对这款机器来说，估计nvidia-bl驱动你也可以调亮度，不过我没试过。我只是把闭源驱动生成的xorg.conf改了改扔给了开源驱动<a href="这个配置文件触摸板不能单击，要改什么，反正我后来用synaptiks设置了。">^3</a>：</p>
<pre><code> ⚡ root@gentoo ⮀ ~ ⮀ cat /etc/X11/xorg.conf 
<span class="preprocessor"># nvidia-xconfig: X configuration file generated by nvidia-xconfig</span>
<span class="preprocessor"># nvidia-xconfig:  version <span class="number">304.64</span>  (buildmeister@swio-display-x86-rhel47-<span class="number">12</span>)  Tue Oct <span class="number">30</span> <span class="number">12</span>:<span class="number">04</span>:<span class="number">46</span> PDT <span class="number">2012</span></span>


Section <span class="string">"ServerLayout"</span>
    Identifier     <span class="string">"Layout0"</span>
    Screen      <span class="number">0</span>  <span class="string">"Screen0"</span> <span class="number">0</span> <span class="number">0</span>
    InputDevice    <span class="string">"Keyboard0"</span> <span class="string">"CoreKeyboard"</span>
    InputDevice    <span class="string">"Mouse0"</span> <span class="string">"CorePointer"</span>
EndSection

Section <span class="string">"Files"</span>
EndSection

Section <span class="string">"InputDevice"</span>

    <span class="preprocessor"># generated from data in <span class="string">"/etc/conf.d/gpm"</span></span>
    Identifier     <span class="string">"Mouse0"</span>
    Driver         <span class="string">"mouse"</span>
    Option         <span class="string">"Protocol"</span>
    Option         <span class="string">"Device"</span> <span class="string">"/dev/input/mice"</span>
    Option         <span class="string">"Emulate3Buttons"</span> <span class="string">"no"</span>
    Option         <span class="string">"ZAxisMapping"</span> <span class="string">"4 5"</span>
EndSection

Section <span class="string">"InputDevice"</span>

    <span class="preprocessor"># generated from default</span>
    Identifier     <span class="string">"Keyboard0"</span>
    Driver         <span class="string">"kbd"</span>
EndSection

Section <span class="string">"Monitor"</span>
    Identifier     <span class="string">"Monitor0"</span>
    Modeline <span class="string">"1368x768_60.00"</span>   <span class="number">85.25</span>  <span class="number">1368</span> <span class="number">1440</span> <span class="number">1576</span> <span class="number">1784</span>  <span class="number">768</span> <span class="number">771</span> <span class="number">781</span> <span class="number">798</span> -hsync +vsync
    Option         <span class="string">"DPMS"</span>
    Option         <span class="string">"PreferredMode"</span>  <span class="string">"1368x768_60.00"</span>
EndSection

Section <span class="string">"Device"</span>
    Identifier     <span class="string">"Device0"</span>
    Driver         <span class="string">"nouveau"</span>
    Option         <span class="string">"NoLogo"</span> <span class="string">"true"</span>
    Option         <span class="string">"RegistryDwords"</span> <span class="string">"EnableBrightnessControl=1"</span>
    VendorName     <span class="string">"NVIDIA Corporation"</span>
EndSection

Section <span class="string">"Screen"</span>
    Identifier     <span class="string">"Screen0"</span>
    Device         <span class="string">"Device0"</span>
    Monitor        <span class="string">"Monitor0"</span>
    DefaultDepth    <span class="number">24</span>
    SubSection     <span class="string">"Display"</span>
        Modes      <span class="string">"1366x768"</span>
        Depth       <span class="number">24</span>
    EndSubSection
EndSection
</code></pre><p>想知道modeline怎么写的？请<code>man cvt</code>。</p>
<p>总之，这么一搞，开源驱动有这款机器的分辨率了。</p>
<p>这部分最后补充下我犯的<em>第二次sb</em>，chroot过去忘了date到正确的时间，结果早上开始emerge kdebase-startkde 晚上发现它还在等着在多少多少秒之后的未来某时开始编译……于是水了一天贴吧发现什么都没干。</p>
<h2 id="后安装时代">后安装时代</h2><p>第三次sb在于，妄图打造一个纯正的无gtk环境，</p>
<ul>
<li>把gvim的gtk参数去掉了，靠……对着wx的gvim渣界面我还奇怪怎么这么难看。</li>
<li>把fcitx的gtk参数去掉了，然后奇怪firefox中怎么输入不了……</li>
<li>最后吧，选择kde环境我觉得本身就挺sb……bug要不要多了点……当你想要美化kde环境下不堪入目的gtk程序而选择安装Oxygen-gtk后，却发现Oxygen-gtk的widget出现不了时你可以参看参看<a href="https://forum.kde.org/viewtopic.php?f=66&amp;t=91301" target="_blank" rel="external">这里</a>。一般情况下，你如果碰到这个问题，说明你要么是升级kde，要么是家目录有一堆以前的配置。</li>
</ul>
<h2 id="引导出错？">引导出错？</h2><p>从W城到X城，十个小时的火车，又犯了一次sb。以为早上六点到X城，半夜两点乘务员把我叫起来说到站了，迷迷糊糊的出站四野一片大雾。晕头转向地走进KFC打开电脑等天亮……草……启动不了了。然后我chroot重编译内核检查硬盘内存一直搞到没电。</p>
<p>等到回家，忽然想起光驱里放了个没用的光盘……</p>
<h2 id="Home">Home</h2><p>回家开始拨号联网，怀念arch下Networkmanager无往不利，按wiki编译设置好。先是发现没无线网络，然后dsl拨号连不上。</p>
<p>这是第几次sb来着……查找N多资料，编译N次内核，n次networkmanager，甚至试了试wicd，最后发现用户名写错了……卧槽啊……</p>
<p>无线内核也是个大坑，gentoo安装手册上说：</p>
<blockquote>
<p>Be aware though, as genkernel compiles a kernel that supports almost all hardware, this compilation will take quite a while to finish! </p>
</blockquote>
<p>还说：</p>
<blockquote>
<p>This means that when you use genkernel to build your kernel, your system will generally detect all your hardware at boot-time, just like our Installation CD does.</p>
</blockquote>
<p>于是我sb的以为会生成个和ubuntu或arch一样的通用内核，实际上竟然不完全是。<a href="问题在于，我是chroot环境过去的，而BT5启动时并没能很好的探测硬件，比如每次启动BT5时间都不对。genkernel貌似需要启动时探测的信息。后来在贴吧看到，都是lspci看硬件然后直接把硬件+gentoo上google搜的……">^1</a>不知道是chroot原因还是什么，RTC支持没有编译(hwclock),无线网卡驱动没有编译(ath9k)，如果你要用vbox，这个支持也要编译上(iommu)。</p>
<p>我觉得最sb的在于，我以为genkernel会自动读取当前目录的配置……各位看官引以为戒，使用软件前认真看手册，不要<em>自以为是</em>。</p>
<p>好了最后没什么了，一个libreoffice编译了五个小时，添加了gentoo-zh和sunrise的overlay。装上了katawa-shoujo，64位gentoo跑32位程序全无压力，连pulse-audio都不用就有声音(arch下为了发出声音必然的依赖)……</p>
<p>然后……就是开虚拟机写毕业设计开题报告的事了。囧……</p>
<h2 id="附录">附录</h2><h3 id="附录一——截图秀">附录一——截图秀</h3><p>这是秀gvim和gentoo的logo：</p>
<p><img src="http://fmn.rrimg.com/fmn061/20130118/2335/original_YQIC_17da0000045a1191.jpg" alt="秀gvim的powerline"></p>
<p>秀zsh的powerline</p>
<p><img src="http://fmn.xnpic.com/fmn057/20130118/2340/original_KSFt_2596000000361191.jpg" alt="yakuake and zsh powerline"></p>
<p>这是秀oxygen主题，金属光泽和性感的阴影。</p>
<p><img src="http://fmn.rrimg.com/fmn060/20130118/2340/original_hO3c_3601000002281190.jpg" alt="日用无碍"></p>
<h3 id="附录二——工作清单">附录二——工作清单</h3><p>终于可以使用中文了。截止</p>
<p>Sun 13 Jan 2013 12:52:51 AM CST</p>
<p>已完成的工作</p>
<p>[X] vlc</p>
<p>[X] gimp</p>
<p>[X] luit/telnet 上听雨</p>
<p>[X] w3m</p>
<p>[X] nouveau</p>
<p>[X] zsh</p>
<p>[X] wqy-zenhei wqy-microhei</p>
<p>[X] ipython pip （python2）</p>
<p>[X] firefox-bin18</p>
<p>[X] startkde(去除bluez，我没有蓝牙适配器)</p>
<p>[X] ppp，dhcpcd</p>
<p>[X] 通用内核</p>
<p>[X] syslinux</p>
<p>[X] 较低版本的fcitx</p>
<p>[X] layman添加gentoo-zh, 安装git和subversion。</p>
<p>[X] xinit</p>
<p>还有些问题：<em>Mon 14 Jan 2013 12:27:09 AM CST修正</em></p>
<p>[X] 分辨率低，不能设置为1366x768,换闭源驱动可解决</p>
<p>[C] gentoo的stageball难道给我装了一堆开发工具？sandbox pyshell pycrust pyalamode？</p>
<p>[X] gvim显示好难看，而且输入法不能起作用，gtk选项</p>
<p>[X] oxygen还要单独安装么？bug，重编译解决</p>
<p>[X] 缺少声卡驱动？还是alsa？声音调节。alsa</p>
<p>[X] 触摸板不起作用。synaptics</p>
<p>[X] 亮度无法调节（kde电源管理工具,and powermanage）开源可以闭源不行,acpid acpi Option依然无力[^4]</p>
<p>[X] dolphin，okular，gwenview等常用工具没装</p>
<p>[X] sudo sudoer文件写法</p>
<p>[X]用户组处理</p>
<p>[]摄像头</p>
<p>[X]如果开源驱动，开启kms</p>
<p>[C]change to nvidiabl</p>
<p>Others:</p>
<p>[X] kdm</p>
<p>[X] vbox安装、配置</p>
<p>[X] 重新编译firefox18,而不是bin</p>
<p>[X] oh-my-zsh 换上有非常漂亮powerline的agnoster主题，上图</p>
<p>[C] overlay 更换现有输入法？<em>注意ICU</em>，暂时不更改了</p>
<p>[X] 片轮少女<a href="悲了个摧的，不能读取我以前的存档……">^2</a></p>
<p>[X] 是否换闭源驱动 是 logo去掉</p>
<p>[X] virtualenv，pip</p>
<p>[C] gcc暂时不升级</p>
<p>幸运的是，家目录没有变动。所有的用户配置都在，如vim，kde，甚至rvm都能正常使用。</p>
<p>Mon 14 Jan 2013 12:30:54 AM CST</p>
<p>除此之外我还做了什么：</p>
<p>[O]恼人的zsh下sudo自动补全。sudo没解决（把配置复制给root了都没用）</p>
<p>[X]精简内核,被genkernel坑了，原来它不会自动读配置</p>
<p>[X]latex编译,ctex字体配置</p>
<p>[X]无线网内核支持编译ath9k</p>
<p>[X]Networkmanager的dsl拨号无法使用</p>
<p>[X]unzip,unrar,zip(natspec标记)</p>
<p>[X]hwclock 内核RTC支持</p>
<p>Sun 03 Mar 2013 11:47:18 AM CST</p>
<p>[X]重新配置内核，添加摄像头支持</p>
<h3 id="附录三——经验教训">附录三——经验教训</h3><ul>
<li>sb一样上来emerge vim…openbox+xterm听雨都显示不了汉字.So,先打造个可以上网的环境再说</li>
<li>chroot是个不错的选择,但不仅要挂载proc等[参见alternative’],还要date…</li>
<li>emerge使用,portage的理解,use 标记 the heart of gentoo.</li>
<li>显卡驱动是个蛋疼的事</li>
<li>firefox编译时直接卡爆，不过最后还是编译好了</li>
<li>gvim和fcitx要加上gtk选项，不然gvim就一个默认的wx界面，fcitx无法在gtk程序中使用</li>
<li>非系统级python模块使用virtualenv+pip</li>
</ul>
<h2 id="Footnotes">Footnotes</h2><p>[^4]: 后来发现acpi没用，powerdevil就够用了。另为唤醒后亮度失控的问题找到解决方法了arch的wiki，在内核启动行加上<code>acpi_osi=Linux acpi_backlight=vendor</code></p>
</span>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/linux/" rel="tag">#linux</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Life/2013/01/06/summary-and-prospect-in-2012/" rel="next" title="总结和展望之2012">
                <i class="fa fa-chevron-left"></i> 总结和展望之2012
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/reviews/2013/01/26/data-analysis-with-open-source-tools/" rel="prev" title="Data Analysis with Open Source Tools">
                Data Analysis with Open Source Tools <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


        </div>

        


        
  <div class="comments" id="comments">
    
  </div>


      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Liu Yuyang" itemprop="image"/>
          <p class="site-author-name" itemprop="name">Liu Yuyang</p>
        </div>
        <p class="site-description motion-element" itemprop="description">我希望生活是诗的，是画的，是无数动听的音符。我希望我是自由的，摇滚的，有一颗黑客的心。</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">165</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">55</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc-indicator-top post-toc-indicator">
            <i class="fa fa-angle-double-up"></i>
          </div>
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#机器信息"><span class="nav-number">1.</span> <span class="nav-text">机器信息</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#:s/arch/gentoo/gc"><span class="nav-number">1.1.</span> <span class="nav-text">:s/arch/gentoo/gc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#引导"><span class="nav-number">1.2.</span> <span class="nav-text">引导</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图形界面"><span class="nav-number">1.3.</span> <span class="nav-text">图形界面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#后安装时代"><span class="nav-number">1.4.</span> <span class="nav-text">后安装时代</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#引导出错？"><span class="nav-number">1.5.</span> <span class="nav-text">引导出错？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Home"><span class="nav-number">1.6.</span> <span class="nav-text">Home</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录"><span class="nav-number">1.7.</span> <span class="nav-text">附录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#附录一——截图秀"><span class="nav-number">1.7.1.</span> <span class="nav-text">附录一——截图秀</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#附录二——工作清单"><span class="nav-number">1.7.2.</span> <span class="nav-text">附录二——工作清单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#附录三——经验教训"><span class="nav-number">1.7.3.</span> <span class="nav-text">附录三——经验教训</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Footnotes"><span class="nav-number">1.8.</span> <span class="nav-text">Footnotes</span></a></li></ol></li></ol></div>
            
          </div>
          <div class="post-toc-indicator-bottom post-toc-indicator">
            <i class="fa fa-angle-double-down"></i>
          </div>
        </section>
      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2011 - 
  <span itemprop="copyrightYear">2015</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liu Yuyang</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
<script type="text/javascript" src="/js/bootstrap.scrollspy.js?v=0.4.5.2" id="bootstrap.scrollspy.custom"></script>


<script type="text/javascript" id="sidebar.toc.highlight">
  $(document).ready(function () {
    var tocSelector = '.post-toc';
    var $tocSelector = $(tocSelector);
    var activeCurrentSelector = '.active-current';

    $tocSelector
      .on('activate.bs.scrollspy', function () {
        var $currentActiveElement = $(tocSelector + ' .active').last();

        removeCurrentActiveClass();
        $currentActiveElement.addClass('active-current');

        $tocSelector[0].scrollTop = $currentActiveElement.position().top;
      })
      .on('clear.bs.scrollspy', function () {
        removeCurrentActiveClass();
      });

    function removeCurrentActiveClass () {
      $(tocSelector + ' ' + activeCurrentSelector)
        .removeClass(activeCurrentSelector.substring(1));
    }

    function processTOC () {
      getTOCMaxHeight();
      toggleTOCOverflowIndicators();
    }

    function getTOCMaxHeight () {
      var height = $('.sidebar').height() -
                   $tocSelector.position().top -
                   $('.post-toc-indicator-bottom').height();

      $tocSelector.css('height', height);

      return height;
    }

    function toggleTOCOverflowIndicators () {
      tocOverflowIndicator(
        '.post-toc-indicator-top',
        $tocSelector.scrollTop() > 0 ? 'show' : 'hide'
      );

      tocOverflowIndicator(
        '.post-toc-indicator-bottom',
        $tocSelector.scrollTop() >= $tocSelector.find('ol').height() - $tocSelector.height() ? 'hide' : 'show'
      )
    }

    $(document).on('sidebar.motion.complete', function () {
      processTOC();
    });

    $('body').scrollspy({ target: tocSelector });
    $(window).on('resize', function () {
      if ( $('.sidebar').hasClass('sidebar-active') ) {
        processTOC();
      }
    });

    onScroll($tocSelector);

    function onScroll (element) {
      element.on('mousewheel DOMMouseScroll', function (event) {
          var oe = event.originalEvent;
          var delta = oe.wheelDelta || -oe.detail;

          this.scrollTop += ( delta < 0 ? 1 : -1 ) * 30;
          event.preventDefault();

          toggleTOCOverflowIndicators();
      });
    }

    function tocOverflowIndicator (indicator, action) {
      var $indicator = $(indicator);
      var opacity = action === 'show' ? 1 : 0;
      $indicator.velocity ?
        $indicator.velocity('stop').velocity({
          opacity: opacity
        }, { duration: 100 }) :
        $indicator.stop().animate({
          opacity: opacity
        }, 100);
    }

  });
</script>

<script type="text/javascript" id="sidebar.nav">
  $(document).ready(function () {
    var html = $('html');
    var TAB_ANIMATE_DURATION = 200;
    var hasVelocity = $.isFunction(html.velocity);

    $('.sidebar-nav li').on('click', function () {
      var item = $(this);
      var activeTabClassName = 'sidebar-nav-active';
      var activePanelClassName = 'sidebar-panel-active';
      if (item.hasClass(activeTabClassName)) {
        return;
      }

      var currentTarget = $('.' + activePanelClassName);
      var target = $('.' + item.data('target'));

      hasVelocity ?
        currentTarget.velocity('transition.slideUpOut', TAB_ANIMATE_DURATION, function () {
          target
            .velocity('stop')
            .velocity('transition.slideDownIn', TAB_ANIMATE_DURATION)
            .addClass(activePanelClassName);
        }) :
        currentTarget.animate({ opacity: 0 }, TAB_ANIMATE_DURATION, function () {
          currentTarget.hide();
          target
            .stop()
            .css({'opacity': 0, 'display': 'block'})
            .animate({ opacity: 1 }, TAB_ANIMATE_DURATION, function () {
              currentTarget.removeClass(activePanelClassName);
              target.addClass(activePanelClassName);
            });
        });

      item.siblings().removeClass(activeTabClassName);
      item.addClass(activeTabClassName);
    });

    $('.post-toc a').on('click', function (e) {
      e.preventDefault();
      var targetSelector = escapeSelector(this.getAttribute('href'));
      var offset = $(targetSelector).offset().top;
      hasVelocity ?
        html.velocity('stop').velocity('scroll', {
          offset: offset  + 'px',
          mobileHA: false
        }) :
        $('html, body').stop().animate({
          scrollTop: offset
        }, 500);
    });

    // Expand sidebar on post detail page by default, when post has a toc.
    motionMiddleWares.sidebar = function () {
      var $tocContent = $('.post-toc-content');
      if (CONFIG.sidebar === 'post') {
        if ($tocContent.length > 0 && $tocContent.html().trim().length > 0) {
          displaySidebar();
        }
      }
    };
  });
</script>



  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
